/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target, mod));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/timeCounterIndex.ts
var timeCounterIndex_exports = {};
__export(timeCounterIndex_exports, {
  TimeCounterSettingTab: () => TimeCounterSettingTab,
  default: () => TimeCounterPlugin
});
module.exports = __toCommonJS(timeCounterIndex_exports);
var import_obsidian9 = require("obsidian");

// src/widgets/counterWidget.ts
var import_view = require("@codemirror/view");
var import_obsidian2 = require("obsidian");

// src/utils/button.ts
var import_obsidian = require("obsidian");
function initButton(app, timeString, markType) {
  const counterEl = createSpan("cm-time-counter-icon");
  const dateFormat = app.plugins.getPlugin("time-counter").settings.timeFormat.trim();
  const parsedTimeFormat = !dateFormat && (dateFormat == null ? void 0 : dateFormat.length) === 0 ? "YYYYMMDDHHmmss" : dateFormat;
  const iconEl = counterEl.createSpan(markType === "start" ? "time-counter-start" : "time-counter-end");
  const button = new import_obsidian.ExtraButtonComponent(iconEl);
  let title, icon;
  if (markType === "start") {
    title = "Remove Time Counter Start Mark";
    icon = "rabbit";
  } else {
    title = "Remove Time Counter End Mark";
    icon = "turtle";
  }
  button.setIcon(icon);
  button.setTooltip((0, import_obsidian.moment)(timeString, parsedTimeFormat).format("YYYY-MM-DD HH:mm:ss"));
  return {
    counterEl,
    iconEl
  };
}

// src/widgets/counterWidget.ts
var CounterMarkWidget = class extends import_view.WidgetType {
  constructor(app, view, from, to, markType = "start", timeString) {
    super();
    this.app = app;
    this.view = view;
    this.from = from;
    this.to = to;
    this.markType = markType;
    this.timeString = timeString;
  }
  eq(other) {
    return other.view === this.view && other.from === this.from && other.to === this.to && other.timeString === this.timeString;
  }
  toDOM() {
    const { counterEl, iconEl } = initButton(this.app, this.timeString, this.markType);
    iconEl.addEventListener("click", (evt) => {
      const menu = new import_obsidian2.Menu();
      menu.addItem((item) => {
        item.setSection("action").setTitle("Edit Time").setIcon("pencil").onClick(() => {
          new TimeCounterModal(this.app, this.timeString, async (replace) => {
            this.view.dispatch({
              changes: {
                from: this.from,
                to: this.to,
                insert: `[${this.markType}::` + replace + "]"
              }
            });
          }).open();
        });
      }).addItem((item) => item.setTitle("Remove").setIcon("x").onClick(() => {
        this.view.dispatch({
          changes: {
            from: this.from,
            to: this.to,
            insert: ""
          }
        });
      })).showAtMouseEvent(evt);
    });
    return counterEl;
  }
  ignoreEvent(event) {
    return false;
  }
};
function counterPlugin(app) {
  return import_view.ViewPlugin.fromClass(class {
    constructor(view) {
      this.view = view;
      this.decorations = import_view.Decoration.none;
      this.matchDecorator = new import_view.MatchDecorator({
        regexp: /\B\[(start|end)::([^\]]*)\]\B/g,
        decoration: this.getDeco.bind(this)
      });
      this.decorations = this.matchDecorator.createDeco(view);
    }
    getDeco(match, _view, pos) {
      const from = pos;
      const to = pos + match[0].length;
      return import_view.Decoration.replace({
        widget: new CounterMarkWidget(app, this.view, from, to, match[1] === "start" ? "start" : "end", match[2])
      });
    }
    update(update) {
      if (!update.state.field(import_obsidian2.editorLivePreviewField)) {
        this.decorations = import_view.Decoration.none;
        return;
      }
      if (update.state.field(import_obsidian2.editorLivePreviewField) !== update.startState.field(import_obsidian2.editorLivePreviewField)) {
        this.decorations = this.matchDecorator.createDeco(update.view);
        return;
      }
      this.decorations = this.matchDecorator.updateDeco(update, this.decorations);
    }
  }, {
    decorations: (v) => v.decorations,
    provide: (plugin) => import_view.EditorView.atomicRanges.of((view) => {
      var _a;
      return ((_a = view.plugin(plugin)) == null ? void 0 : _a.decorations) || import_view.Decoration.none;
    })
  });
}
var TimeCounterModal = class extends import_obsidian2.Modal {
  constructor(app, value, cb) {
    super(app);
    this.cb = cb;
    this.currentValue = value;
  }
  onOpen() {
    let { contentEl } = this;
    contentEl.toggleClass("time-mark-ask-modal", true);
    contentEl.createEl("div", { text: "Change Time" });
    const buttonContainer = contentEl.createDiv({ cls: "button-container" });
    const textComponent = new import_obsidian2.TextComponent(buttonContainer);
    textComponent.setValue(this.currentValue);
    textComponent.onChange(async (value) => {
      this.currentValue = value;
    });
    new import_obsidian2.ButtonComponent(buttonContainer).setClass("do-not-remove").setButtonText("OK").onClick(async () => {
      await this.cb(this.currentValue);
      this.close();
    });
  }
};

// src/widgets/lineMarkWidget.ts
var import_view2 = require("@codemirror/view");
var import_obsidian5 = require("obsidian");
var import_state = require("@codemirror/state");

// src/utils/domUtils.ts
var import_obsidian4 = require("obsidian");

// src/const.ts
var taskItemRegex = /-\s\[(.)\]/g;
var blankTaskItemRegex = /-\s\[\s\]/g;
var startTimestampRegex = /(\s)?\[start::([^\]]*)\]/;
var endTimestampRegex = /(\s)?\[end::([^\]]*)\]/;
var clockLineRegex = /^\s*CLOCK:(.*)=>\s*(\d{2}:\d{2}:\d{2})\s*$/;

// src/utils/utils.ts
var import_obsidian3 = require("obsidian");
function updateTimeEl(timeEl, timeString) {
  if (timeString.days > 0) {
    timeEl.createSpan({
      cls: "time-mark-days",
      text: `${timeString.days} days `
    });
  }
  if (timeString.hours > 0) {
    timeEl.createSpan({
      cls: "time-mark-hours",
      text: `${timeString.hours} hrs `
    });
  }
  if (timeString.minutes > 0) {
    timeEl.createSpan({
      cls: "time-mark-minutes",
      text: `${timeString.minutes} mins `
    });
  }
  if (timeString.days === 0 && timeString.hours === 0 && timeString.seconds >= 0) {
    timeEl.createSpan({
      cls: "time-mark-seconds",
      text: `${timeString.seconds} secs `
    });
  }
}
function formatDuration(start, end) {
  const duration = import_obsidian3.moment.duration(end.diff(start));
  const days = duration.days();
  const hours = duration.hours();
  const minutes = duration.minutes();
  const seconds = duration.seconds();
  let realDays = days;
  const months = duration.months();
  const years = duration.years();
  if (years > 0) {
    realDays += years * 365;
  }
  if (months > 0) {
    realDays += months * 30;
  }
  return {
    days: realDays,
    hours,
    minutes,
    seconds
  };
}
function calculateLength(time) {
  let secondsLength = 0;
  let minutesLength = 0;
  let hoursLength = 0;
  let daysLength = 0;
  if (time.days > 0) {
    daysLength = (time.days < 10 ? 1 : time.days.toString(10).length) + " days".length;
  }
  if (time.hours > 0) {
    hoursLength = (time.hours < 10 ? 1 : 2) + " hrs ".length;
  }
  if (time.minutes > 0) {
    minutesLength = (time.minutes < 10 ? 1 : 2) + " mins".length;
  }
  if (time.days === 0 && time.hours === 0 && (time.seconds === 0 && time.minutes === 0 || time.seconds > 0)) {
    secondsLength = (time.seconds < 10 ? 1 : 2) + " secs".length;
  }
  if (time.days === 0 && time.hours === 0 && time.minutes === 0) {
    return (time.seconds < 10 ? 3 : 2) + " secs".length;
  }
  return daysLength + hoursLength + minutesLength + secondsLength + 2;
}
function checkPairsAndLastMark(timeString) {
  const startTimeMarks = timeString.matchAll(new RegExp(startTimestampRegex, "g"));
  const endTimeMarks = timeString.matchAll(new RegExp(endTimestampRegex, "g"));
  const startTimeMarksArray = Array.from(startTimeMarks);
  const endTimeMarksArray = Array.from(endTimeMarks);
  const isPairs = startTimeMarksArray.length === endTimeMarksArray.length;
  const lastMark = isPairs ? startTimeMarksArray.length > 0 ? "end" : "none" : "start";
  return {
    isPairs,
    lastMark
  };
}
var checkIfBlankLastChar = (text) => /\s$/.test(text);
var checkIfTaskDate = (text) => {
  return text.match(/âœ… \d{4}-\d{2}-\d{2}/);
};
var checkBlockId = (text) => {
  return text.match(/\^[a-zA-Z0-9-]{2,}$/);
};
function calculateFromAndTo(line, lineText, type, app) {
  var _a, _b;
  const dateFormat = app.plugins.getPlugin("time-counter").settings.timeFormat.trim();
  const parsedTimeFormat = !dateFormat && (dateFormat == null ? void 0 : dateFormat.length) === 0 ? "YYYYMMDDHHmmss" : dateFormat;
  const timestamp = (0, import_obsidian3.moment)().format(parsedTimeFormat);
  const dateIndex = (_a = checkIfTaskDate(lineText)) == null ? void 0 : _a.index;
  const blockIdIndex = (_b = checkBlockId(lineText)) == null ? void 0 : _b.index;
  let insertText = "";
  if (dateIndex) {
    insertText = `${checkIfBlankLastChar(lineText.slice(0, dateIndex)) ? `` : ` `}[${type}::${timestamp}] `;
  } else if (blockIdIndex) {
    insertText = `${checkIfBlankLastChar(lineText.slice(0, blockIdIndex)) ? `` : ` `}[${type}::${timestamp}] `;
  } else {
    insertText = `${checkIfBlankLastChar(lineText) ? `` : ` `}[${type}::${timestamp}]`;
  }
  let targetFrom = dateIndex ? line.from + dateIndex : blockIdIndex ? line.from + blockIdIndex : line.to;
  let targetTo = dateIndex ? line.from + dateIndex : blockIdIndex ? line.from + blockIdIndex : line.to;
  return {
    targetFrom,
    targetTo,
    insertText
  };
}

// src/utils/domUtils.ts
var TIME_MARK_REGEX = "\\[(start|end)::([^\\]]*)\\]";
function splitTimeString(time) {
  var _a, _b;
  const markType = (_a = time.match(TIME_MARK_REGEX)) == null ? void 0 : _a[1];
  const timeString = (_b = time.match(TIME_MARK_REGEX)) == null ? void 0 : _b[2];
  return {
    timeString,
    markType
  };
}
var rules = [
  {
    regexPattern: "(\\[start::[^\\]]*\\])",
    creator: (app, matchedText) => {
      const { timeString } = splitTimeString(matchedText);
      if (!timeString)
        return createSpan("cm-time-counter-icon");
      const { counterEl } = initButton(app, timeString, "start");
      return counterEl;
    }
  },
  {
    regexPattern: "(\\[end::[^\\]]*\\])",
    creator: (app, matchedText) => {
      const { timeString } = splitTimeString(matchedText);
      if (!timeString)
        return createSpan("cm-time-counter-icon");
      const { counterEl } = initButton(app, timeString, "end");
      return counterEl;
    }
  }
];
function highlightTextInElement(app, element, rules2) {
  const walker = document.createTreeWalker(element, NodeFilter.SHOW_TEXT);
  let node;
  const nodesToProcess = [];
  while (node = walker.nextNode()) {
    nodesToProcess.push(node);
  }
  nodesToProcess.forEach((node2) => {
    replaceTextWithElements(app, node2, rules2);
  });
}
function replaceTextWithElements(app, node, rules2) {
  var _a;
  if (node.nodeType === Node.TEXT_NODE) {
    let textContent = node.textContent || "";
    rules2.forEach((rule) => {
      let newTextContent = "";
      let match;
      const regex = new RegExp(rule.regexPattern, "g");
      let lastIndex = 0;
      while ((match = regex.exec(textContent)) !== null) {
        const part = match[0];
        const precedingText = textContent.substring(lastIndex, match.index);
        newTextContent += precedingText;
        const replacementElement = rule.creator(app, part);
        newTextContent += `<span data-replace>${replacementElement.outerHTML}</span>`;
        lastIndex = regex.lastIndex;
      }
      newTextContent += textContent.substring(lastIndex);
      textContent = newTextContent;
    });
    const parser = new DOMParser();
    const doc = parser.parseFromString(textContent, "text/html");
    Array.from(doc.body.childNodes).forEach((newNode) => {
      var _a2;
      if (newNode.nodeName === "SPAN" && newNode.getAttribute("data-replace")) {
        Array.from(newNode.childNodes).forEach((child) => {
          var _a3;
          (_a3 = node.parentNode) == null ? void 0 : _a3.insertBefore(child.cloneNode(true), node);
        });
      } else {
        (_a2 = node.parentNode) == null ? void 0 : _a2.insertBefore(newNode.cloneNode(true), node);
      }
    });
    (_a = node.parentNode) == null ? void 0 : _a.removeChild(node);
  }
}
function appendElementPreview(app, element, createAElement) {
  var _a, _b, _c, _d;
  const tasksPluginEnabled = app.plugins.getPlugin("obsidian-tasks-plugin");
  const startRegex = /\[(start::([^\]]*)\])/;
  const endRegex = /\[(end::([^\]]*)\])/;
  const walker = document.createTreeWalker(element, NodeFilter.SHOW_TEXT);
  let node;
  while (node = walker.nextNode()) {
    const matches = [...node.textContent.matchAll(/\B\[start::([^\]]*)\]\B(.*?)\B\[end::([^\]]*)\]\B/g)];
    if (matches.length) {
      const timeMarks = [];
      for (const match of matches) {
        const timeStart = match[1];
        const timeEnd = match[3];
        timeMarks.push({
          timeStart,
          timeEnd
        });
      }
      let time = calculateMultiTime(app, timeMarks);
      const newElement = createAElement(time);
      const parent = node.parentNode;
      if ((parent == null ? void 0 : parent.nodeName) !== "LI" && tasksPluginEnabled) {
        if (((_a = parent == null ? void 0 : parent.parentNode) == null ? void 0 : _a.nodeName) === "SPAN") {
          const spanParent = (_d = (_c = (_b = parent.parentNode) == null ? void 0 : _b.parentNode) == null ? void 0 : _c.parentNode) == null ? void 0 : _d.parentNode;
          spanParent == null ? void 0 : spanParent.appendChild(newElement);
          continue;
        }
      }
      parent == null ? void 0 : parent.appendChild(newElement);
      continue;
    }
  }
}
function initInlineTimeCounterMark(time) {
  const counterEl = createSpan("cm-time-mark-icon");
  let timeString = time;
  const timeStringWidth = calculateLength(timeString) * 8;
  const timeEl = counterEl.createSpan({
    cls: "time-mark"
  });
  updateTimeEl(timeEl, timeString);
  counterEl.style.width = `${timeStringWidth + 20}px`;
  return counterEl;
}
function createLogbookTimeMarkInPreviewMode(element, createAElement) {
  var _a, _b, _c;
  const logbookNodes = [];
  const endNodes = [];
  const walker = document.createTreeWalker(element, NodeFilter.SHOW_TEXT);
  let node;
  while (node = walker.nextNode()) {
    if (node.nodeType === Node.TEXT_NODE && node.textContent.includes(":logbook:")) {
      logbookNodes.push(node);
    }
    if (node.nodeType === Node.TEXT_NODE && node.textContent.includes(":END:")) {
      endNodes.push(node);
    }
  }
  if (logbookNodes.length !== endNodes.length) {
    console.error("Mismatched :logbook: and :END: pairs.");
    return;
  }
  for (let i = 0; i < logbookNodes.length; i++) {
    const startNode = logbookNodes[i];
    const endNode = endNodes[i];
    let currentNode = startNode;
    let logbookContent = "";
    while (currentNode && currentNode !== endNode.nextSibling) {
      logbookContent += currentNode.textContent + "\n";
      currentNode = currentNode.nextSibling;
    }
    const newElement = createAElement(logbookContent);
    if (!newElement)
      continue;
    if (element.nodeName === "DIV" && startNode.parentNode.nodeName === "P") {
      (_a = element.firstChild) == null ? void 0 : _a.prepend(newElement);
    } else if (((_b = startNode.parentNode) == null ? void 0 : _b.nodeName) === "LI") {
      (_c = startNode.parentNode) == null ? void 0 : _c.prepend(newElement);
    }
  }
}
function initLogbookTimeCounterMark(content) {
  var _a;
  const counterEl = createSpan("cm-time-mark-icon");
  const lines = content.trim().split("\n");
  const match = lines.filter((line) => clockLineRegex.test(line));
  if (match.length === 0)
    return counterEl;
  let totalTime = (0, import_obsidian4.moment)("00:00:00", "HH:mm:ss");
  for (let i = 0; i < match.length; i++) {
    let time = (_a = match[i].match(clockLineRegex)) == null ? void 0 : _a[2];
    if (time) {
      let date = (0, import_obsidian4.moment)(time, "HH:mm:ss");
      if (date.isValid()) {
        totalTime.add(import_obsidian4.moment.duration(time));
      }
    }
  }
  const duration = formatDuration((0, import_obsidian4.moment)("00:00:00", "HH:mm:ss"), totalTime);
  const logBookEl = counterEl.createSpan({
    cls: "time-mark"
  });
  const timeStringWidth = calculateLength(duration) * 8;
  updateTimeEl(logBookEl, duration);
  counterEl.style.width = `${timeStringWidth}px`;
  return counterEl;
}

// src/widgets/lineMarkWidget.ts
function isTimeMarkArray2(time) {
  return Array.isArray(time);
}
function calculateMultiTime(app, time) {
  const dateFormat = app.plugins.getPlugin("time-counter").settings.timeFormat.trim();
  const parsedTimeFormat = !dateFormat && (dateFormat == null ? void 0 : dateFormat.length) === 0 ? "YYYYMMDDHHmmss" : dateFormat;
  let totalDuration = {
    days: 0,
    hours: 0,
    minutes: 0,
    seconds: 0
  };
  for (let i = 0; i < time.length; i++) {
    const startMoment = (0, import_obsidian5.moment)(time[i].timeStart, parsedTimeFormat);
    const endMoment = (0, import_obsidian5.moment)(time[i].timeEnd, parsedTimeFormat);
    const duration = formatDuration(startMoment, endMoment);
    totalDuration.days += duration.days;
    totalDuration.hours += duration.hours;
    totalDuration.minutes += duration.minutes;
    totalDuration.seconds += duration.seconds;
  }
  return totalDuration;
}
function calculateSingleTime2(app, time) {
  const dateFormat = app.plugins.getPlugin("time-counter").settings.timeFormat.trim();
  const parsedTimeFormat = !dateFormat && (dateFormat == null ? void 0 : dateFormat.length) === 0 ? "YYYYMMDDHHmmss" : dateFormat;
  const start = (0, import_obsidian5.moment)(time.timeStart, parsedTimeFormat);
  const end = (0, import_obsidian5.moment)(time.timeEnd, parsedTimeFormat);
  if (!start.isValid() || !end.isValid())
    return null;
  return formatDuration(start, end);
}
var TimeMarkWidget = class extends import_view2.WidgetType {
  constructor(app, view, from, to, time) {
    super();
    this.app = app;
    this.view = view;
    this.from = from;
    this.to = to;
    this.time = time;
  }
  eq(other) {
    return other.view === this.view && other.from === this.from && other.to === this.to && other.time === this.time;
  }
  toDOM() {
    const isMulti = isTimeMarkArray2(this.time);
    let timeString = isMulti ? calculateMultiTime(this.app, this.time) : calculateSingleTime2(this.app, this.time);
    if (!timeString) {
      return createSpan("cm-time-mark-icon");
    }
    return initInlineTimeCounterMark(timeString);
  }
  ignoreEvent(event) {
    return false;
  }
};
function buildCounterDecos(app, view) {
  const builder = new import_state.RangeSetBuilder();
  const seen = /* @__PURE__ */ new Set();
  for (const { from, to } of view.visibleRanges) {
    for (let pos = from; pos <= to; ) {
      const line = view.state.doc.lineAt(pos);
      const matches = [...line.text.matchAll(/\B\[start::([^\]]*)\]\B(.*?)\B\[end::([^\]]*)\]\B/g)];
      if (matches.length) {
        const timeMarks = [];
        for (const match of matches) {
          if (seen.has(line.from) && matches.length === 1)
            break;
          seen.add(line.from);
          const timeStart = match[1];
          const timeEnd = match[3];
          timeMarks.push({
            timeStart,
            timeEnd
          });
        }
        builder.add(line.to, line.to, import_view2.Decoration.widget({
          widget: new TimeMarkWidget(app, view, pos, line.to, timeMarks.length > 1 ? timeMarks : timeMarks[0]),
          side: 1
        }));
      }
      pos = line.to + 1;
    }
  }
  return builder.finish();
}
var lineEndWidgetPlugin = (app) => {
  return import_view2.ViewPlugin.fromClass(class {
    constructor(view) {
      this.decorations = buildCounterDecos(app, view);
    }
    update(update) {
      if (update.docChanged || update.viewportChanged) {
        this.decorations = buildCounterDecos(app, update.view);
      }
    }
  }, {
    decorations: (v) => v.decorations
  });
};

// src/widgets/taskToggle.ts
var import_state2 = require("@codemirror/state");
var import_view3 = require("@codemirror/view");
var insertTimestamp = (update, condition, type, app) => {
  const changes = [];
  const timestampRegex = type === "start" ? startTimestampRegex : endTimestampRegex;
  update.changes.iterChanges((fromA, toA, fromB, toB, inserted) => {
    if (inserted.toString().match(timestampRegex) || inserted.toString().split("\n").length > 1)
      return;
    const fromLine = update.state.doc.lineAt(fromA);
    if (!update.state.doc.line(fromLine.number).text.startsWith("- "))
      return;
    const toLine = update.state.doc.lineAt(fromB);
    for (let i = fromLine.number; i <= toLine.number; i++) {
      const line = update.state.doc.line(i);
      const lineText = line.text;
      const current = checkPairsAndLastMark(lineText);
      if (condition(lineText, inserted.toString())) {
        if (type === "end" && !(current.lastMark === "start"))
          return;
        if (type === "start" && current.lastMark === "start")
          return;
        const change = calculateFromAndTo(line, lineText, type, app);
        changes.push({
          from: change.targetFrom,
          to: change.targetTo,
          insert: change.insertText
        });
      }
    }
  });
  return changes;
};
var removeTimestamps = (lineText, type) => {
  let timestampRegex = type === "start" ? startTimestampRegex : endTimestampRegex;
  if (!timestampRegex.global) {
    const flags = timestampRegex.flags + "g";
    timestampRegex = new RegExp(timestampRegex.source, flags);
  }
  let match;
  let lastMatch = null;
  while ((match = timestampRegex.exec(lineText)) !== null) {
    lastMatch = match;
  }
  if (lastMatch) {
    const timestampPos = lineText.indexOf(lastMatch[0]);
    return {
      from: timestampPos,
      to: timestampPos + lastMatch[0].length
    };
  }
  return null;
};
var addTaskTimeMarkPlugin = (app) => {
  return import_view3.ViewPlugin.fromClass(class {
    update(update) {
      if (!update.docChanged)
        return;
      if (update.transactions.some((tr) => tr.annotation(import_state2.Transaction.userEvent) === "undo" || tr.annotation(import_state2.Transaction.userEvent) === "redo" || tr.annotation(import_state2.Transaction.userEvent) === "plugin-update"))
        return;
      const startChanges = insertTimestamp(update, (lineText, inserted) => {
        return new RegExp(taskItemRegex).test(lineText) && (/- \[\s\]/g.test(inserted) || /-\s\[\s\]$/g.test(lineText));
      }, "start", app);
      const endChanges = insertTimestamp(update, (lineText, inserted) => {
        return new RegExp(taskItemRegex).test(lineText) && (/- \[[^\s]\]/g.test(inserted) || /-\s\[[^\s]\]/g.test(lineText) && /(x|X)/g.test(inserted));
      }, "end", app);
      const changes = [...startChanges, ...endChanges];
      if (update.transactions.some((tr) => tr.annotation(import_state2.Transaction.userEvent) === "plugin-update"))
        return;
      if (changes.length > 0) {
        setTimeout(() => {
          const tr = update.view.state.update({
            changes: import_state2.ChangeSet.of(changes, update.view.state.doc.length)
          });
          update.view.dispatch(tr);
        }, 0);
      }
    }
  });
};
var removeTaskTimeMarkPlugin = import_view3.ViewPlugin.fromClass(class {
  update(update) {
    if (!update.docChanged)
      return;
    if (update.transactions.some((tr) => tr.annotation(import_state2.Transaction.userEvent) === "undo" || tr.annotation(import_state2.Transaction.userEvent) === "redo" || tr.annotation(import_state2.Transaction.userEvent) === "plugin-update"))
      return;
    let changes = [];
    update.changes.iterChanges((fromA, toA, fromB, toB, inserted) => {
      const fromLine = update.state.doc.lineAt(fromA);
      const toLine = update.state.doc.lineAt(fromB);
      if (!inserted.toString().includes("- ") && !inserted.toString().includes("- [ ]") && !/\s/.test(inserted.toString())) {
        return;
      }
      if (!fromLine.text.trim().startsWith("- ") && !fromLine.text.trim().startsWith("- [ ]")) {
        return;
      }
      const current = checkPairsAndLastMark(fromLine.text);
      if (current.lastMark === "start" && !/^-$/g.test(inserted.toString().trim())) {
        return;
      }
      const insertBlankTask = inserted.toString().includes("- [ ]");
      const insertBulletMark = /^-$/.test(inserted.toString().trim());
      const insertBlankWord = /\s/.test(inserted.toString()) && fromLine.text.trim().startsWith("- [ ]");
      if (current.lastMark === "end" && !(insertBulletMark || insertBlankWord) || current.lastMark === "end" && insertBlankTask) {
        return;
      }
      for (let i = fromLine.number; i <= toLine.number; i++) {
        const line = update.state.doc.line(i);
        const lineText = line.text;
        const matchTaskItem = new RegExp(taskItemRegex).test(lineText);
        const containsStartTimestamp = new RegExp(startTimestampRegex).test(lineText);
        const containsEndTimestamp = new RegExp(endTimestampRegex).test(lineText);
        if (!matchTaskItem && containsStartTimestamp && containsEndTimestamp) {
          const start = removeTimestamps(lineText, "start");
          const end = removeTimestamps(lineText, "end");
          if (start && !end)
            changes.push({ from: line.from + start.from, to: line.from + start.to });
          if (end && !start)
            changes.push({ from: line.from + end.from, to: line.from + end.to });
          if (start && end) {
            changes.push({ from: line.from + start.from, to: line.from + start.to });
            changes.push({ from: line.from + end.from, to: line.from + end.to });
          }
        }
        if (matchTaskItem && new RegExp(blankTaskItemRegex).test(lineText) && containsEndTimestamp) {
          const end = removeTimestamps(lineText, "end");
          if (end)
            changes.push({ from: line.from + end.from, to: line.from + end.to });
        }
      }
    });
    if (update.transactions.some((tr) => tr.annotation(import_state2.Transaction.userEvent) === "plugin-update"))
      return;
    if (changes.length > 0) {
      setTimeout(() => {
        const tr = update.view.state.update({
          changes: import_state2.ChangeSet.of(changes, update.view.state.doc.length),
          annotations: import_state2.Transaction.userEvent.of("plugin-update")
        });
        update.view.dispatch(tr);
      }, 0);
    }
  }
});

// src/utils/line.ts
var import_obsidian6 = require("obsidian");
var insertMark = (app, editor, type) => {
  const format = app.plugins.getPlugin("time-counter").settings.timeFormat.trim();
  const time = (0, import_obsidian6.moment)().format(format);
  const selection = editor.getSelection();
  if (selection.trim().length > 0)
    return;
  editor.replaceSelection(`[${type}::${time}]`);
};
var checkExistStartMark = (editor) => {
  const getPos = editor.getCursor("from");
  const getLine = editor.getLine(getPos.line);
  const match = getLine.match(startTimestampRegex);
  if (match)
    return true;
  return false;
};

// src/widgets/logBookWidget.ts
var import_view4 = require("@codemirror/view");
var import_state3 = require("@codemirror/state");
var logbookField = import_state3.StateField.define({
  create: (state) => {
    var _a;
    let ranges = [];
    let lines = [];
    if (state.doc.length > 0) {
      lines = Array.from({ length: state.doc.lines }, (_, i) => i + 1);
    }
    for (let n of lines) {
      let line = state.doc.line(n);
      let fromIdx = line.text.indexOf(":logbook:");
      if (fromIdx !== -1) {
        let endIdx = -1;
        for (let i = n; i < state.doc.length; i++) {
          if (((_a = state.doc.line(i)) == null ? void 0 : _a.text.indexOf(":END:")) !== -1) {
            endIdx = state.doc.line(i).to;
            break;
          }
        }
        if (endIdx !== -1) {
          let from = state.doc.line(n).from - 1;
          ranges.push({ from, to: endIdx });
        }
      }
    }
    return ranges;
  },
  update(value, tr) {
    var _a;
    if (!tr.docChanged)
      return value;
    let ranges = [];
    let lines = [];
    if (tr.state.doc.length > 0) {
      lines = Array.from({ length: tr.state.doc.lines }, (_, i) => i + 1);
    }
    for (let n of lines) {
      let line = tr.state.doc.line(n);
      let fromIdx = line.text.indexOf(":logbook:");
      if (fromIdx !== -1) {
        let endIdx = -1;
        for (let i = n; i < tr.newDoc.length; i++) {
          const currentEditing = tr.newSelection.ranges[0].from;
          const lineNum = tr.newDoc.lineAt(currentEditing).number;
          if (lineNum === i) {
            break;
          }
          if (((_a = tr.newDoc.line(i)) == null ? void 0 : _a.text.indexOf(":END:")) !== -1) {
            endIdx = tr.newDoc.line(i).to;
            break;
          }
        }
        if (endIdx !== -1) {
          let from = tr.state.doc.line(n).from - 1;
          ranges.push({ from, to: endIdx });
        }
      }
    }
    return ranges;
  }
});
var InlineLogbook = class extends import_view4.WidgetType {
  constructor(view, from, to, content) {
    super();
    this.view = view;
    this.from = from;
    this.to = to;
    this.content = content;
  }
  eq(other) {
    return other.view === this.view && other.from === this.from && other.to === this.to && other.content === this.content;
  }
  toDOM() {
    return initLogbookTimeCounterMark(this.content);
  }
  ignoreEvent(event) {
    return false;
  }
};
var logbookDecorations = import_state3.StateField.define({
  create: (state) => {
    let builder = new import_state3.RangeSetBuilder();
    let doc = state.doc;
    let logbookRanges = state.field(logbookField, false) || [];
    for (let range of logbookRanges) {
      let content = doc.sliceString(range.from, range.to);
      let widget = import_view4.Decoration.widget({
        widget: new InlineLogbook(state, range.from, range.to, content)
      });
      builder.add(range.from, range.from, widget);
    }
    return builder.finish();
  },
  update(decorations, tr) {
    if (!tr.docChanged)
      return decorations;
    let builder = new import_state3.RangeSetBuilder();
    let doc = tr.state.doc;
    let logbookRanges = tr.state.field(logbookField, false) || [];
    for (let range of logbookRanges) {
      let content = doc.sliceString(range.from, range.to);
      let widget = import_view4.Decoration.widget({
        widget: new InlineLogbook(tr.state, range.from, range.to, content)
      });
      builder.add(range.from, range.from, widget);
    }
    return builder.finish();
  },
  provide: (f) => import_view4.EditorView.decorations.from(f)
});

// src/widgets/playWidget.ts
var import_view5 = require("@codemirror/view");
var import_obsidian7 = require("obsidian");
var import_state4 = require("@codemirror/state");
var PlayWidget = class extends import_view5.WidgetType {
  constructor(app, view, from, type, line) {
    super();
    this.app = app;
    this.view = view;
    this.from = from;
    this.type = type;
    this.line = line;
  }
  eq(other) {
    return other.view === this.view && other.from === this.from && other.type === this.type && other.line === this.line;
  }
  toDOM() {
    let icon = createSpan("cm-time-counter-play-button");
    if (this.type === "start") {
      (0, import_obsidian7.setIcon)(icon, "timer");
      icon.toggleClass("cm-play-button-end", false);
    } else if (this.type === "end") {
      (0, import_obsidian7.setIcon)(icon, "timer-off");
      icon.toggleClass("cm-play-button-end", true);
    }
    icon.addEventListener("click", () => {
      const change = calculateFromAndTo(this.line, this.line.text, this.type, this.app);
      const tr = this.view.state.update({
        changes: { from: change.targetFrom, to: change.targetTo, insert: change.insertText },
        scrollIntoView: true,
        annotations: import_state4.Transaction.userEvent.of("plugin-update"),
        selection: {
          anchor: change.targetTo + change.insertText.length || 0,
          head: change.targetTo + change.insertText.length || 0
        }
      });
      this.view.dispatch(tr);
    });
    return icon;
  }
  ignoreEvent(event) {
    return false;
  }
};
function buildPlayDecos(app, view) {
  const builder = new import_state4.RangeSetBuilder();
  const seen = /* @__PURE__ */ new Set();
  for (const { from, to } of view.visibleRanges) {
    for (let pos = from; pos <= to; ) {
      const line = view.state.doc.lineAt(pos);
      if (!seen.has(line.from)) {
        seen.add(line.from);
        const insertMarks = checkPairsAndLastMark(line.text);
        const currentType = insertMarks.lastMark === "start" ? "end" : "start";
        builder.add(line.from, line.from, import_view5.Decoration.widget({
          widget: new PlayWidget(app, view, pos, currentType, line),
          side: -1
        }));
      }
      pos = line.to + 1;
    }
  }
  return builder.finish();
}
var playWidgetPlugin = (app) => {
  return import_view5.ViewPlugin.fromClass(class {
    constructor(view) {
      this.decorations = buildPlayDecos(app, view);
    }
    update(update) {
      if (update.docChanged || update.viewportChanged) {
        this.decorations = buildPlayDecos(app, update.view);
      }
    }
  }, {
    decorations: (v) => v.decorations
  });
};

// src/crypto/index.ts
var crypto = __toESM(require("crypto"));
var import_obsidian8 = require("obsidian");
var SERVER_URL = "api.boninall.com";
var API_PATH = "/ob/validate";
var Registration = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.dbPath = this.plugin.app.vault.configDir + "/register.db";
  }
  async init() {
    const fileExists = await this.plugin.app.vault.adapter.exists((0, import_obsidian8.normalizePath)(this.dbPath));
    if (!fileExists) {
      const random = crypto.randomBytes(25).toString("hex");
      const doubleMD5 = this.md5(this.md5(random));
      await this.plugin.app.vault.create(this.dbPath, doubleMD5);
    }
  }
  async getMachineCode() {
    const fileExists = await this.plugin.app.vault.adapter.exists((0, import_obsidian8.normalizePath)(this.dbPath));
    if (!fileExists) {
      return "";
    }
    const content = await this.plugin.app.vault.adapter.read((0, import_obsidian8.normalizePath)(this.dbPath));
    return this.md5(this.md5(content));
  }
  async getRegCode() {
    const regCode = this.plugin.settings.regCode;
    if (regCode) {
      return regCode;
    } else {
      return "";
    }
  }
  async checkStatus(machineId) {
    const url = `https://${SERVER_URL}${API_PATH}`;
    const method = "POST";
    const contentType = "application/json";
    const regCode = await this.getRegCode();
    if (!regCode) {
      return "";
    }
    const body = JSON.stringify({
      machineId,
      resKey: "obsidian-" + this.plugin.manifest.id,
      regCode
    });
    const headers = {
      "Content-Type": contentType
    };
    const request = {
      url,
      method,
      contentType,
      body,
      headers
    };
    try {
      const response = (0, import_obsidian8.requestUrl)(request);
      const responseBody = await response.text;
      return responseBody;
    } catch (error) {
      console.error("Request failed:", error);
      return "";
    }
  }
  md5(data) {
    return crypto.createHash("md5").update(data).digest("hex");
  }
  sha1(data) {
    return crypto.createHash("sha1").update(data).digest("hex");
  }
};

// src/timeCounterIndex.ts
var DEFAULT_SETTINGS = {
  timeFormat: "YYYYMMDDHHmmss",
  alreadyNoticeFormat: false,
  alreadyNoticePro: false,
  regCode: ""
};
var TimeCounterPlugin = class extends import_obsidian9.Plugin {
  async onload() {
    await this.loadSettings();
    await this.initRegister();
    this.addSettingTab(new TimeCounterSettingTab(this.app, this.registration, this));
    if (!this.settings.alreadyNoticeFormat) {
      new NoticeModal(this.app, "", async (ready) => {
        if (!ready) {
          this.settings.alreadyNoticeFormat = true;
          await this.saveSettings();
        }
      }).open();
    }
    this.addIcons();
    this.registerEditorExtension([lineEndWidgetPlugin(this.app), addTaskTimeMarkPlugin(this.app)]);
    this.registerContextMenu();
    this.registerCommands();
    this.registerMarkdownPostProcessor((el, ctx) => {
      appendElementPreview(this.app, el, initInlineTimeCounterMark);
    });
    this.app.workspace.onLayoutReady(() => {
      this.checkStatus(() => {
        this.registerEditorExtension([
          playWidgetPlugin(this.app),
          counterPlugin(this.app),
          removeTaskTimeMarkPlugin,
          logbookField,
          logbookDecorations
        ]);
        this.registerMarkdownPostProcessor((el, ctx) => {
          highlightTextInElement(this.app, el, rules);
          createLogbookTimeMarkInPreviewMode(el, initLogbookTimeCounterMark);
        });
      });
    });
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  addIcons() {
    (0, import_obsidian9.addIcon)("turtle", `<g id="surface1"><path style="fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:4;" d="M 12 10.000312 L 13.999688 13.999688 L 13.999688 16.999688 C 13.999688 17.551875 14.447812 18 15 18 L 16.999688 18 C 17.551875 18 18 17.551875 18 16.999688 L 18 13.999688 C 18 9.582187 14.417813 6 10.000312 6 C 5.581875 6 1.999687 9.582187 1.999687 13.999688 L 1.999687 16.999688 C 1.999687 17.551875 2.447812 18 3 18 L 4.999687 18 C 5.551875 18 6 17.551875 6 16.999688 L 6 13.999688 L 7.999687 10.000312 Z M 12 10.000312 " transform="matrix(4.166667,0,0,4.166667,0,0)"/><path style="fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:4;" d="M 4.819687 7.900313 L 7.999687 10.000312 " transform="matrix(4.166667,0,0,4.166667,0,0)"/><path style="fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:4;" d="M 15.18 7.900313 L 12 10.000312 " transform="matrix(4.166667,0,0,4.166667,0,0)"/><path style="fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:4;" d="M 16.930312 10.000312 L 19.999688 10.000312 C 21.105 10.000312 22.000312 10.895625 22.000312 12 C 22.000312 13.104375 21.105 13.999688 19.999688 13.999688 L 1.999687 13.999688 " transform="matrix(4.166667,0,0,4.166667,0,0)"/></g>`);
    (0, import_obsidian9.addIcon)("rabbit", `<g id="surface1"><path style="fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:4;" d="M 19.999688 8.539687 L 19.999688 4.000312 C 19.999688 2.895 19.104375 1.999687 18 1.999687 C 16.895625 1.999687 16.000312 2.895 16.000312 4.000312 L 16.000312 7.000312 " transform="matrix(4.166667,0,0,4.166667,0,0)"/><path style="fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:4;" d="M 18 21 L 10.000312 21 C 7.790625 21 6 19.209375 6 16.999688 C 6 13.134375 9.134062 10.000312 13.000312 10.000312 L 13.2 10.000312 L 9.6 6.400313 C 8.826562 5.626875 8.826562 4.373437 9.6 3.6 C 10.373437 2.826563 11.626875 2.826563 12.400313 3.6 L 15.799687 7.000312 L 16.000312 7.000312 C 19.300313 7.000312 22.000312 9.700312 22.000312 13.000312 L 22.000312 13.999688 C 22.000312 15.105 21.105 16.000312 19.999688 16.000312 L 19.000312 16.000312 C 17.299688 16.000312 16.000312 17.299688 16.000312 19.000312 " transform="matrix(4.166667,0,0,4.166667,0,0)"/><path style="fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:4;" d="M 7.609687 12.529687 C 6.827812 11.145 5.1 10.611562 3.673125 11.314687 C 2.245312 12.016875 1.615312 13.711875 2.235937 15.17625 C 2.856562 16.640625 4.512187 17.36625 6.010312 16.83 " transform="matrix(4.166667,0,0,4.166667,0,0)"/><path style="fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:4;" d="M 13.000312 16.000312 C 14.183438 15.998437 15.257812 16.693125 15.741562 17.773125 C 16.225313 18.854062 16.029375 20.117812 15.24 21 " transform="matrix(4.166667,0,0,4.166667,0,0)"/><path style="fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:4;" d="M 18 12 L 18.010312 12 " transform="matrix(4.166667,0,0,4.166667,0,0)"/></g>`);
  }
  registerContextMenu() {
    this.registerEvent(this.app.workspace.on("editor-menu", (menu, editor) => {
      if (!editor) {
        return;
      }
      const selection = editor.getSelection();
      menu.addItem((item) => {
        const subMenu = item.setSection("action").setTitle(`Time Counter`).setIcon("alarm-clock").setSubmenu();
        subMenu.addItem((item2) => {
          item2.setIcon("rabbit").setTitle("Mark Start Time").setDisabled(!!selection.trim()).onClick(() => insertMark(this.app, editor, "start"));
        });
        subMenu.addItem((item2) => {
          item2.setIcon("turtle").setTitle("Mark End Time").setDisabled(!!selection.trim() || !checkExistStartMark(editor)).onClick(() => insertMark(this.app, editor, "end"));
        });
      });
    }));
  }
  registerCommands() {
    this.addCommand({
      id: "mark-as-start",
      name: "Mark Time Start",
      editorCallback: (editor) => insertMark(this.app, editor, "start")
    });
    this.addCommand({
      id: "mark-as-end",
      name: "Mark Time End",
      editorCallback: (editor) => {
        if (!checkExistStartMark(editor))
          return;
        insertMark(this.app, editor, "end");
      }
    });
    this.addCommand({
      id: "remove-all-markers",
      name: "Remove All Time Markers In Current File",
      callback: async () => {
        const markdownView = this.app.workspace.getActiveViewOfType(import_obsidian9.MarkdownView);
        if (markdownView) {
          const file = markdownView.file;
          let ready = false;
          new AskModal(this.app, "to remove", async (already) => {
            ready = already;
            if (ready && file) {
              const fileContent = await this.app.vault.cachedRead(file);
              const newFileContent = fileContent.replace(/(\s)?\[start::([^\]]*)\]|(\s)?\[end::([^\]]*)\]/g, "");
              await this.app.vault.modify(file, newFileContent);
            }
          }).open();
          return;
        }
        new import_obsidian9.Notice("No active file open");
      }
    });
  }
  async initRegister() {
    this.registration = new Registration(this);
    await this.registration.init();
  }
  async checkStatus(cb) {
    const machineId = await this.registration.getMachineCode();
    const status = await this.registration.checkStatus(machineId);
    if (!status) {
      if (!this.settings.alreadyNoticePro) {
        new import_obsidian9.Notice("Some Features is not available in free version");
        this.settings.alreadyNoticePro = true;
        await this.saveSettings();
      }
      return;
    }
    const result = JSON.parse(status);
    result.message === "succeed" ? result.regCode ? await this.saveStatus(result.regCode, cb) : result.expiryDate && (0, import_obsidian9.moment)(result.expiryDate, "YYYYMMDD").isBefore((0, import_obsidian9.moment)()) || cb() : this.settings.alreadyNoticePro || new import_obsidian9.Notice("Please activate Time Mark plugin");
  }
  async saveStatus(regCode, cb) {
    this.settings.regCode = regCode;
    this.settings.alreadyNoticePro = true;
    cb();
    await this.saveSettings();
  }
};
var AskModal = class extends import_obsidian9.Modal {
  constructor(app, title, cb) {
    super(app);
    this.title = title;
    this.cb = cb;
  }
  onOpen() {
    let { contentEl } = this;
    contentEl.toggleClass("time-mark-ask-modal", true);
    contentEl.createEl("div", { text: "Are you sure" } + this.title + "?");
    const buttonContainer = contentEl.createDiv({ cls: "button-container" });
    new import_obsidian9.ButtonComponent(buttonContainer).setClass("remove-ready").setWarning().setButtonText("Yes").onClick(async () => {
      await this.cb(true);
      this.close();
    });
    new import_obsidian9.ButtonComponent(buttonContainer).setClass("do-not-remove").setButtonText("No").onClick(async () => {
      await this.cb(false);
      this.close();
    });
  }
};
var NoticeModal = class extends import_obsidian9.Modal {
  constructor(app, title, cb) {
    super(app);
    this.title = title;
    this.cb = cb;
  }
  onOpen() {
    let { contentEl } = this;
    contentEl.toggleClass("time-mark-notice-modal", true);
    contentEl.createEl("div", { text: "Time Format for time counter", cls: "time-counter-modal-title" });
    contentEl.createEl("div", {
      text: "Default time format is YYYYMMDDHHmmss. but you can change it in settings now!",
      cls: "time-counter-notice"
    });
    contentEl.createEl("div", { text: "Do you want to go to settings?", cls: "time-counter-notice" });
    const buttonContainer = contentEl.createDiv({ cls: "button-container" });
    new import_obsidian9.ButtonComponent(buttonContainer).setClass("go-settings").setWarning().setButtonText("Go to change").onClick(async () => {
      await this.cb(false);
      this.app.setting.open();
      this.app.setting.openTabById("time-counter");
      this.close();
    });
    new import_obsidian9.ButtonComponent(buttonContainer).setClass("do-not-go-settings").setButtonText("Confirm").onClick(async () => {
      await this.cb(false);
      this.close();
    });
  }
  async onClose() {
    super.onClose();
    await this.cb(false);
  }
};
var TimeCounterSettingTab = class extends import_obsidian9.PluginSettingTab {
  constructor(app, registration, plugin) {
    super(app, plugin);
    this.applyDebounceTimer = 0;
    this.plugin = plugin;
    this.registration = registration;
  }
  applySettingsUpdate() {
    clearTimeout(this.applyDebounceTimer);
    const plugin = this.plugin;
    this.applyDebounceTimer = window.setTimeout(() => {
      plugin.saveSettings();
    }, 100);
  }
  async hide() {
  }
  async display() {
    const { containerEl } = this;
    this.containerEl.empty();
    const desc = document.createDocumentFragment();
    desc.append("Use ", createEl("a", { href: "https://momentjs.com/docs/#/displaying/" }, (el) => {
      el.innerText = "Moment.js format";
    }), " to customize the time format. ", createEl("span", {
      text: "Please reload Obsidian after changing the format.",
      cls: "time-counter-desc"
    }));
    new import_obsidian9.Setting(containerEl).setName("Time Format").setDesc(desc).addText((text) => {
      text.setPlaceholder(DEFAULT_SETTINGS.timeFormat).setValue(this.plugin.settings.timeFormat).onChange(async (value) => {
        this.plugin.settings.timeFormat = value;
        this.applySettingsUpdate();
      });
    });
    this.checkPro(containerEl);
  }
  async checkPro(containerEl) {
    const machineCode = await this.registration.getMachineCode();
    const status = await this.registration.checkStatus(machineCode);
    if (status) {
      if (JSON.parse(status).message === "succeed") {
        const expiryDate = JSON.parse(status).expiryDate;
        const proStatusDesc = document.createDocumentFragment();
        proStatusDesc.append("You have purchased the Time-Counter Pro version, with an activation date until ", createEl("span", {
          text: (0, import_obsidian9.moment)(expiryDate, "YYYYMMDD").format("YYYY-MM-DD"),
          cls: "time-counter-desc"
        }), ". ");
        new import_obsidian9.Setting(containerEl).setName("Version Status").setDesc(proStatusDesc);
        return;
      }
    }
    const statusDesc = document.createDocumentFragment();
    statusDesc.append("Please enter the register code to activate the pro version. ", createEl("span", {
      text: "Please reload Obsidian after changing the register code.",
      cls: "time-counter-desc"
    }));
    new import_obsidian9.Setting(containerEl).setName("Register Code").setDesc(statusDesc).addButton((button) => {
      button.setButtonText("Activate").setCta().onClick(async () => {
        const regCode = this.plugin.settings.regCode;
        if (regCode === "") {
          new import_obsidian9.Notice("Please enter the register code!");
          return;
        }
        const machineCode2 = await this.registration.getMachineCode();
        const status2 = await this.registration.checkStatus(machineCode2);
        if (status2) {
          if (JSON.parse(status2).message === "succeed") {
            this.plugin.settings.regCode = JSON.parse(status2).regCode || regCode;
            this.applySettingsUpdate();
            if (JSON.parse(status2).regCode && (0, import_obsidian9.moment)(JSON.parse(status2).expiryDate, "YYYYMMDD").isAfter((0, import_obsidian9.moment)())) {
              this.plugin.registerEditorExtension([
                playWidgetPlugin(this.app),
                counterPlugin(this.app),
                removeTaskTimeMarkPlugin,
                logbookField,
                logbookDecorations
              ]);
              this.plugin.registerMarkdownPostProcessor((el, ctx) => {
                highlightTextInElement(this.app, el, rules);
                createLogbookTimeMarkInPreviewMode(el, initLogbookTimeCounterMark);
              });
            }
            new import_obsidian9.Notice("Activation succeeded!");
            await this.display();
            return;
          }
        }
        new import_obsidian9.Notice("Activation failed!");
      });
    }).addText((text) => {
      text.setPlaceholder(DEFAULT_SETTINGS.regCode).setValue(this.plugin.settings.regCode).onChange(async (value) => {
        this.plugin.settings.regCode = value;
        this.applySettingsUpdate();
      });
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL3RpbWVDb3VudGVySW5kZXgudHMiLCAic3JjL3dpZGdldHMvY291bnRlcldpZGdldC50cyIsICJzcmMvdXRpbHMvYnV0dG9uLnRzIiwgInNyYy93aWRnZXRzL2xpbmVNYXJrV2lkZ2V0LnRzIiwgInNyYy91dGlscy9kb21VdGlscy50cyIsICJzcmMvY29uc3QudHMiLCAic3JjL3V0aWxzL3V0aWxzLnRzIiwgInNyYy93aWRnZXRzL3Rhc2tUb2dnbGUudHMiLCAic3JjL3V0aWxzL2xpbmUudHMiLCAic3JjL3dpZGdldHMvbG9nQm9va1dpZGdldC50cyIsICJzcmMvd2lkZ2V0cy9wbGF5V2lkZ2V0LnRzIiwgInNyYy9jcnlwdG8vaW5kZXgudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7XG4gICAgYWRkSWNvbixcbiAgICBBcHAsXG4gICAgQnV0dG9uQ29tcG9uZW50LFxuICAgIEVkaXRvcixcbiAgICBNYXJrZG93blZpZXcsXG4gICAgTWVudSxcbiAgICBNZW51SXRlbSxcbiAgICBNb2RhbCxcbiAgICBtb21lbnQsXG4gICAgTm90aWNlLFxuICAgIFBsdWdpbixcbiAgICBQbHVnaW5TZXR0aW5nVGFiLFxuICAgIFNldHRpbmcsXG59IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgY291bnRlclBsdWdpbiB9IGZyb20gXCIuL3dpZGdldHMvY291bnRlcldpZGdldFwiO1xuaW1wb3J0IHsgbGluZUVuZFdpZGdldFBsdWdpbiB9IGZyb20gXCIuL3dpZGdldHMvbGluZU1hcmtXaWRnZXRcIjtcbmltcG9ydCB7IGFkZFRhc2tUaW1lTWFya1BsdWdpbiwgcmVtb3ZlVGFza1RpbWVNYXJrUGx1Z2luIH0gZnJvbSBcIi4vd2lkZ2V0cy90YXNrVG9nZ2xlXCI7XG5pbXBvcnQgeyBjaGVja0V4aXN0U3RhcnRNYXJrLCBpbnNlcnRNYXJrIH0gZnJvbSBcIi4vdXRpbHMvbGluZVwiO1xuaW1wb3J0IHsgbG9nYm9va0RlY29yYXRpb25zLCBsb2dib29rRmllbGQgfSBmcm9tIFwiLi93aWRnZXRzL2xvZ0Jvb2tXaWRnZXRcIjtcbmltcG9ydCB7XG4gICAgYXBwZW5kRWxlbWVudFByZXZpZXcsXG4gICAgY3JlYXRlTG9nYm9va1RpbWVNYXJrSW5QcmV2aWV3TW9kZSxcbiAgICBoaWdobGlnaHRUZXh0SW5FbGVtZW50LFxuICAgIGluaXRJbmxpbmVUaW1lQ291bnRlck1hcmssXG4gICAgaW5pdExvZ2Jvb2tUaW1lQ291bnRlck1hcmssXG4gICAgcnVsZXMsXG59IGZyb20gXCIuL3V0aWxzL2RvbVV0aWxzXCI7XG5pbXBvcnQgeyBwbGF5V2lkZ2V0UGx1Z2luIH0gZnJvbSBcIi4vd2lkZ2V0cy9wbGF5V2lkZ2V0XCI7XG5pbXBvcnQgeyBSZWdpc3RyYXRpb24gfSBmcm9tIFwiLi9jcnlwdG9cIjtcblxuaW50ZXJmYWNlIFRpbWVDb3VudGVyU2V0dGluZ3Mge1xuICAgIHRpbWVGb3JtYXQ6IHN0cmluZztcbiAgICBhbHJlYWR5Tm90aWNlRm9ybWF0OiBib29sZWFuO1xuICAgIGFscmVhZHlOb3RpY2VQcm86IGJvb2xlYW47XG4gICAgcmVnQ29kZTogc3RyaW5nO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBUaW1lQ291bnRlclNldHRpbmdzID0ge1xuICAgIHRpbWVGb3JtYXQ6IFwiWVlZWU1NRERISG1tc3NcIixcbiAgICBhbHJlYWR5Tm90aWNlRm9ybWF0OiBmYWxzZSxcbiAgICBhbHJlYWR5Tm90aWNlUHJvOiBmYWxzZSxcbiAgICByZWdDb2RlOiBcIlwiLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGltZUNvdW50ZXJQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHB1YmxpYyBzZXR0aW5nczogVGltZUNvdW50ZXJTZXR0aW5ncztcbiAgICBwcml2YXRlIHJlZ2lzdHJhdGlvbjogUmVnaXN0cmF0aW9uO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgICAgICBhd2FpdCB0aGlzLmluaXRSZWdpc3RlcigpO1xuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IFRpbWVDb3VudGVyU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcy5yZWdpc3RyYXRpb24sIHRoaXMpKTtcblxuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuYWxyZWFkeU5vdGljZUZvcm1hdCkge1xuICAgICAgICAgICAgbmV3IE5vdGljZU1vZGFsKHRoaXMuYXBwLCBcIlwiLCBhc3luYyAocmVhZHkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIXJlYWR5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuYWxyZWFkeU5vdGljZUZvcm1hdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkub3BlbigpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hZGRJY29ucygpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRWRpdG9yRXh0ZW5zaW9uKFtsaW5lRW5kV2lkZ2V0UGx1Z2luKHRoaXMuYXBwKSwgYWRkVGFza1RpbWVNYXJrUGx1Z2luKHRoaXMuYXBwKV0pO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyQ29udGV4dE1lbnUoKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlckNvbW1hbmRzKCk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJNYXJrZG93blBvc3RQcm9jZXNzb3IoKGVsLCBjdHgpID0+IHtcbiAgICAgICAgICAgIGFwcGVuZEVsZW1lbnRQcmV2aWV3KHRoaXMuYXBwLCBlbCwgaW5pdElubGluZVRpbWVDb3VudGVyTWFyayk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNoZWNrU3RhdHVzKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlZ2lzdGVyRWRpdG9yRXh0ZW5zaW9uKFtcbiAgICAgICAgICAgICAgICAgICAgcGxheVdpZGdldFBsdWdpbih0aGlzLmFwcCksXG4gICAgICAgICAgICAgICAgICAgIGNvdW50ZXJQbHVnaW4odGhpcy5hcHApLFxuICAgICAgICAgICAgICAgICAgICByZW1vdmVUYXNrVGltZU1hcmtQbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgIGxvZ2Jvb2tGaWVsZCxcbiAgICAgICAgICAgICAgICAgICAgbG9nYm9va0RlY29yYXRpb25zLFxuICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJNYXJrZG93blBvc3RQcm9jZXNzb3IoKGVsLCBjdHgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0VGV4dEluRWxlbWVudCh0aGlzLmFwcCwgZWwsIHJ1bGVzKTtcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlTG9nYm9va1RpbWVNYXJrSW5QcmV2aWV3TW9kZShlbCwgaW5pdExvZ2Jvb2tUaW1lQ291bnRlck1hcmspO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9udW5sb2FkKCkge31cblxuICAgIHB1YmxpYyBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBhZGRJY29ucygpIHtcbiAgICAgICAgYWRkSWNvbihcbiAgICAgICAgICAgIFwidHVydGxlXCIsXG4gICAgICAgICAgICBgPGcgaWQ9XCJzdXJmYWNlMVwiPjxwYXRoIHN0eWxlPVwiZmlsbDpub25lO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2U6cmdiKDAlLDAlLDAlKTtzdHJva2Utb3BhY2l0eToxO3N0cm9rZS1taXRlcmxpbWl0OjQ7XCIgZD1cIk0gMTIgMTAuMDAwMzEyIEwgMTMuOTk5Njg4IDEzLjk5OTY4OCBMIDEzLjk5OTY4OCAxNi45OTk2ODggQyAxMy45OTk2ODggMTcuNTUxODc1IDE0LjQ0NzgxMiAxOCAxNSAxOCBMIDE2Ljk5OTY4OCAxOCBDIDE3LjU1MTg3NSAxOCAxOCAxNy41NTE4NzUgMTggMTYuOTk5Njg4IEwgMTggMTMuOTk5Njg4IEMgMTggOS41ODIxODcgMTQuNDE3ODEzIDYgMTAuMDAwMzEyIDYgQyA1LjU4MTg3NSA2IDEuOTk5Njg3IDkuNTgyMTg3IDEuOTk5Njg3IDEzLjk5OTY4OCBMIDEuOTk5Njg3IDE2Ljk5OTY4OCBDIDEuOTk5Njg3IDE3LjU1MTg3NSAyLjQ0NzgxMiAxOCAzIDE4IEwgNC45OTk2ODcgMTggQyA1LjU1MTg3NSAxOCA2IDE3LjU1MTg3NSA2IDE2Ljk5OTY4OCBMIDYgMTMuOTk5Njg4IEwgNy45OTk2ODcgMTAuMDAwMzEyIFogTSAxMiAxMC4wMDAzMTIgXCIgdHJhbnNmb3JtPVwibWF0cml4KDQuMTY2NjY3LDAsMCw0LjE2NjY2NywwLDApXCIvPjxwYXRoIHN0eWxlPVwiZmlsbDpub25lO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2U6cmdiKDAlLDAlLDAlKTtzdHJva2Utb3BhY2l0eToxO3N0cm9rZS1taXRlcmxpbWl0OjQ7XCIgZD1cIk0gNC44MTk2ODcgNy45MDAzMTMgTCA3Ljk5OTY4NyAxMC4wMDAzMTIgXCIgdHJhbnNmb3JtPVwibWF0cml4KDQuMTY2NjY3LDAsMCw0LjE2NjY2NywwLDApXCIvPjxwYXRoIHN0eWxlPVwiZmlsbDpub25lO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2U6cmdiKDAlLDAlLDAlKTtzdHJva2Utb3BhY2l0eToxO3N0cm9rZS1taXRlcmxpbWl0OjQ7XCIgZD1cIk0gMTUuMTggNy45MDAzMTMgTCAxMiAxMC4wMDAzMTIgXCIgdHJhbnNmb3JtPVwibWF0cml4KDQuMTY2NjY3LDAsMCw0LjE2NjY2NywwLDApXCIvPjxwYXRoIHN0eWxlPVwiZmlsbDpub25lO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2U6cmdiKDAlLDAlLDAlKTtzdHJva2Utb3BhY2l0eToxO3N0cm9rZS1taXRlcmxpbWl0OjQ7XCIgZD1cIk0gMTYuOTMwMzEyIDEwLjAwMDMxMiBMIDE5Ljk5OTY4OCAxMC4wMDAzMTIgQyAyMS4xMDUgMTAuMDAwMzEyIDIyLjAwMDMxMiAxMC44OTU2MjUgMjIuMDAwMzEyIDEyIEMgMjIuMDAwMzEyIDEzLjEwNDM3NSAyMS4xMDUgMTMuOTk5Njg4IDE5Ljk5OTY4OCAxMy45OTk2ODggTCAxLjk5OTY4NyAxMy45OTk2ODggXCIgdHJhbnNmb3JtPVwibWF0cml4KDQuMTY2NjY3LDAsMCw0LjE2NjY2NywwLDApXCIvPjwvZz5gLFxuICAgICAgICApO1xuICAgICAgICBhZGRJY29uKFxuICAgICAgICAgICAgXCJyYWJiaXRcIixcbiAgICAgICAgICAgIGA8ZyBpZD1cInN1cmZhY2UxXCI+PHBhdGggc3R5bGU9XCJmaWxsOm5vbmU7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZTpyZ2IoMCUsMCUsMCUpO3N0cm9rZS1vcGFjaXR5OjE7c3Ryb2tlLW1pdGVybGltaXQ6NDtcIiBkPVwiTSAxOS45OTk2ODggOC41Mzk2ODcgTCAxOS45OTk2ODggNC4wMDAzMTIgQyAxOS45OTk2ODggMi44OTUgMTkuMTA0Mzc1IDEuOTk5Njg3IDE4IDEuOTk5Njg3IEMgMTYuODk1NjI1IDEuOTk5Njg3IDE2LjAwMDMxMiAyLjg5NSAxNi4wMDAzMTIgNC4wMDAzMTIgTCAxNi4wMDAzMTIgNy4wMDAzMTIgXCIgdHJhbnNmb3JtPVwibWF0cml4KDQuMTY2NjY3LDAsMCw0LjE2NjY2NywwLDApXCIvPjxwYXRoIHN0eWxlPVwiZmlsbDpub25lO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2U6cmdiKDAlLDAlLDAlKTtzdHJva2Utb3BhY2l0eToxO3N0cm9rZS1taXRlcmxpbWl0OjQ7XCIgZD1cIk0gMTggMjEgTCAxMC4wMDAzMTIgMjEgQyA3Ljc5MDYyNSAyMSA2IDE5LjIwOTM3NSA2IDE2Ljk5OTY4OCBDIDYgMTMuMTM0Mzc1IDkuMTM0MDYyIDEwLjAwMDMxMiAxMy4wMDAzMTIgMTAuMDAwMzEyIEwgMTMuMiAxMC4wMDAzMTIgTCA5LjYgNi40MDAzMTMgQyA4LjgyNjU2MiA1LjYyNjg3NSA4LjgyNjU2MiA0LjM3MzQzNyA5LjYgMy42IEMgMTAuMzczNDM3IDIuODI2NTYzIDExLjYyNjg3NSAyLjgyNjU2MyAxMi40MDAzMTMgMy42IEwgMTUuNzk5Njg3IDcuMDAwMzEyIEwgMTYuMDAwMzEyIDcuMDAwMzEyIEMgMTkuMzAwMzEzIDcuMDAwMzEyIDIyLjAwMDMxMiA5LjcwMDMxMiAyMi4wMDAzMTIgMTMuMDAwMzEyIEwgMjIuMDAwMzEyIDEzLjk5OTY4OCBDIDIyLjAwMDMxMiAxNS4xMDUgMjEuMTA1IDE2LjAwMDMxMiAxOS45OTk2ODggMTYuMDAwMzEyIEwgMTkuMDAwMzEyIDE2LjAwMDMxMiBDIDE3LjI5OTY4OCAxNi4wMDAzMTIgMTYuMDAwMzEyIDE3LjI5OTY4OCAxNi4wMDAzMTIgMTkuMDAwMzEyIFwiIHRyYW5zZm9ybT1cIm1hdHJpeCg0LjE2NjY2NywwLDAsNC4xNjY2NjcsMCwwKVwiLz48cGF0aCBzdHlsZT1cImZpbGw6bm9uZTtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlOnJnYigwJSwwJSwwJSk7c3Ryb2tlLW9wYWNpdHk6MTtzdHJva2UtbWl0ZXJsaW1pdDo0O1wiIGQ9XCJNIDcuNjA5Njg3IDEyLjUyOTY4NyBDIDYuODI3ODEyIDExLjE0NSA1LjEgMTAuNjExNTYyIDMuNjczMTI1IDExLjMxNDY4NyBDIDIuMjQ1MzEyIDEyLjAxNjg3NSAxLjYxNTMxMiAxMy43MTE4NzUgMi4yMzU5MzcgMTUuMTc2MjUgQyAyLjg1NjU2MiAxNi42NDA2MjUgNC41MTIxODcgMTcuMzY2MjUgNi4wMTAzMTIgMTYuODMgXCIgdHJhbnNmb3JtPVwibWF0cml4KDQuMTY2NjY3LDAsMCw0LjE2NjY2NywwLDApXCIvPjxwYXRoIHN0eWxlPVwiZmlsbDpub25lO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2U6cmdiKDAlLDAlLDAlKTtzdHJva2Utb3BhY2l0eToxO3N0cm9rZS1taXRlcmxpbWl0OjQ7XCIgZD1cIk0gMTMuMDAwMzEyIDE2LjAwMDMxMiBDIDE0LjE4MzQzOCAxNS45OTg0MzcgMTUuMjU3ODEyIDE2LjY5MzEyNSAxNS43NDE1NjIgMTcuNzczMTI1IEMgMTYuMjI1MzEzIDE4Ljg1NDA2MiAxNi4wMjkzNzUgMjAuMTE3ODEyIDE1LjI0IDIxIFwiIHRyYW5zZm9ybT1cIm1hdHJpeCg0LjE2NjY2NywwLDAsNC4xNjY2NjcsMCwwKVwiLz48cGF0aCBzdHlsZT1cImZpbGw6bm9uZTtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlOnJnYigwJSwwJSwwJSk7c3Ryb2tlLW9wYWNpdHk6MTtzdHJva2UtbWl0ZXJsaW1pdDo0O1wiIGQ9XCJNIDE4IDEyIEwgMTguMDEwMzEyIDEyIFwiIHRyYW5zZm9ybT1cIm1hdHJpeCg0LjE2NjY2NywwLDAsNC4xNjY2NjcsMCwwKVwiLz48L2c+YCxcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICByZWdpc3RlckNvbnRleHRNZW51KCkge1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJlZGl0b3ItbWVudVwiLCAobWVudTogTWVudSwgZWRpdG9yOiBFZGl0b3IpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGVkaXRvci5nZXRTZWxlY3Rpb24oKTtcblxuICAgICAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbTogTWVudUl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3ViTWVudSA9IGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRTZWN0aW9uKFwiYWN0aW9uXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoYFRpbWUgQ291bnRlcmApXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcImFsYXJtLWNsb2NrXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0U3VibWVudSgpO1xuICAgICAgICAgICAgICAgICAgICBzdWJNZW51LmFkZEl0ZW0oKGl0ZW06IE1lbnVJdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJyYWJiaXRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoXCJNYXJrIFN0YXJ0IFRpbWVcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0RGlzYWJsZWQoISFzZWxlY3Rpb24udHJpbSgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IGluc2VydE1hcmsodGhpcy5hcHAsIGVkaXRvciwgXCJzdGFydFwiKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzdWJNZW51LmFkZEl0ZW0oKGl0ZW06IE1lbnVJdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJ0dXJ0bGVcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoXCJNYXJrIEVuZCBUaW1lXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNldERpc2FibGVkKCEhc2VsZWN0aW9uLnRyaW0oKSB8fCAhY2hlY2tFeGlzdFN0YXJ0TWFyayhlZGl0b3IpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IGluc2VydE1hcmsodGhpcy5hcHAsIGVkaXRvciwgXCJlbmRcIikpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHJlZ2lzdGVyQ29tbWFuZHMoKSB7XG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogXCJtYXJrLWFzLXN0YXJ0XCIsXG4gICAgICAgICAgICBuYW1lOiBcIk1hcmsgVGltZSBTdGFydFwiLFxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvcikgPT4gaW5zZXJ0TWFyayh0aGlzLmFwcCwgZWRpdG9yLCBcInN0YXJ0XCIpLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwibWFyay1hcy1lbmRcIixcbiAgICAgICAgICAgIG5hbWU6IFwiTWFyayBUaW1lIEVuZFwiLFxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvcikgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghY2hlY2tFeGlzdFN0YXJ0TWFyayhlZGl0b3IpKSByZXR1cm47XG4gICAgICAgICAgICAgICAgaW5zZXJ0TWFyayh0aGlzLmFwcCwgZWRpdG9yLCBcImVuZFwiKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogXCJyZW1vdmUtYWxsLW1hcmtlcnNcIixcbiAgICAgICAgICAgIG5hbWU6IFwiUmVtb3ZlIEFsbCBUaW1lIE1hcmtlcnMgSW4gQ3VycmVudCBGaWxlXCIsXG4gICAgICAgICAgICAvLyBVc2luZyBjYWxsYmFjayBpbnN0ZWFkIG9mIGNoZWNrQ2FsbGJhY2sgYmVjYXVzZSB3ZSB3YW50IHRvIHVzaW5nIGFzeW5jL2F3YWl0XG4gICAgICAgICAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1hcmtkb3duVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgICAgICAgICAgaWYgKG1hcmtkb3duVmlldykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gbWFya2Rvd25WaWV3LmZpbGU7XG4gICAgICAgICAgICAgICAgICAgIGxldCByZWFkeSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBuZXcgQXNrTW9kYWwodGhpcy5hcHAsIFwidG8gcmVtb3ZlXCIsIGFzeW5jIChhbHJlYWR5OiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkeSA9IGFscmVhZHk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVhZHkgJiYgZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdGaWxlQ29udGVudCA9IGZpbGVDb250ZW50LnJlcGxhY2UoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8oXFxzKT9cXFtzdGFydDo6KFteXFxdXSopXFxdfChcXHMpP1xcW2VuZDo6KFteXFxdXSopXFxdL2csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3RmlsZUNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KS5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIk5vIGFjdGl2ZSBmaWxlIG9wZW5cIik7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhc3luYyBpbml0UmVnaXN0ZXIoKSB7XG4gICAgICAgIHRoaXMucmVnaXN0cmF0aW9uID0gbmV3IFJlZ2lzdHJhdGlvbih0aGlzKTtcbiAgICAgICAgYXdhaXQgdGhpcy5yZWdpc3RyYXRpb24uaW5pdCgpO1xuICAgIH1cblxuICAgIGFzeW5jIGNoZWNrU3RhdHVzKGNiOiAoKSA9PiB2b2lkKSB7XG4gICAgICAgIGNvbnN0IG1hY2hpbmVJZCA9IGF3YWl0IHRoaXMucmVnaXN0cmF0aW9uLmdldE1hY2hpbmVDb2RlKCk7XG4gICAgICAgIGNvbnN0IHN0YXR1cyA9IGF3YWl0IHRoaXMucmVnaXN0cmF0aW9uLmNoZWNrU3RhdHVzKG1hY2hpbmVJZCk7XG4gICAgICAgIGlmICghc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MuYWxyZWFkeU5vdGljZVBybykge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJTb21lIEZlYXR1cmVzIGlzIG5vdCBhdmFpbGFibGUgaW4gZnJlZSB2ZXJzaW9uXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuYWxyZWFkeU5vdGljZVBybyA9IHRydWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXN1bHQ6IFJlc3VsdCA9IEpTT04ucGFyc2Uoc3RhdHVzKTtcbiAgICAgICAgcmVzdWx0Lm1lc3NhZ2UgPT09IFwic3VjY2VlZFwiXG4gICAgICAgICAgICA/IHJlc3VsdC5yZWdDb2RlXG4gICAgICAgICAgICAgICAgPyBhd2FpdCB0aGlzLnNhdmVTdGF0dXMocmVzdWx0LnJlZ0NvZGUsIGNiKVxuICAgICAgICAgICAgICAgIDogKHJlc3VsdC5leHBpcnlEYXRlICYmIG1vbWVudChyZXN1bHQuZXhwaXJ5RGF0ZSwgXCJZWVlZTU1ERFwiKS5pc0JlZm9yZShtb21lbnQoKSkpIHx8IGNiKClcbiAgICAgICAgICAgIDogdGhpcy5zZXR0aW5ncy5hbHJlYWR5Tm90aWNlUHJvIHx8IG5ldyBOb3RpY2UoXCJQbGVhc2UgYWN0aXZhdGUgVGltZSBNYXJrIHBsdWdpblwiKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU3RhdHVzKHJlZ0NvZGU6IHN0cmluZywgY2I6ICgpID0+IHZvaWQpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5yZWdDb2RlID0gcmVnQ29kZTtcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5hbHJlYWR5Tm90aWNlUHJvID0gdHJ1ZTtcbiAgICAgICAgY2IoKTtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcbiAgICB9XG59XG5cbmNsYXNzIEFza01vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHByaXZhdGUgY2I6IChyZWFkeTogYm9vbGVhbikgPT4gUHJvbWlzZTx2b2lkPjtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBhcHA6IEFwcCxcbiAgICAgICAgcmVhZG9ubHkgdGl0bGU6IHN0cmluZyxcbiAgICAgICAgY2I6IChyZWFkeTogYm9vbGVhbikgPT4gUHJvbWlzZTx2b2lkPixcbiAgICApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5jYiA9IGNiO1xuICAgIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgbGV0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwudG9nZ2xlQ2xhc3MoXCJ0aW1lLW1hcmstYXNrLW1vZGFsXCIsIHRydWUpO1xuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIkFyZSB5b3Ugc3VyZVwiIH0gKyB0aGlzLnRpdGxlICsgXCI/XCIpO1xuICAgICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImJ1dHRvbi1jb250YWluZXJcIiB9KTtcblxuICAgICAgICBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXRDbGFzcyhcInJlbW92ZS1yZWFkeVwiKVxuICAgICAgICAgICAgLnNldFdhcm5pbmcoKVxuICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJZZXNcIilcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNiKHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXRDbGFzcyhcImRvLW5vdC1yZW1vdmVcIilcbiAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiTm9cIilcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNiKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XG5cbmNsYXNzIE5vdGljZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHByaXZhdGUgY2I6IChyZWFkeTogYm9vbGVhbikgPT4gUHJvbWlzZTx2b2lkPjtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBhcHA6IEFwcCxcbiAgICAgICAgcmVhZG9ubHkgdGl0bGU6IHN0cmluZyxcbiAgICAgICAgY2I6IChyZWFkeTogYm9vbGVhbikgPT4gUHJvbWlzZTx2b2lkPixcbiAgICApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5jYiA9IGNiO1xuICAgIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgbGV0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwudG9nZ2xlQ2xhc3MoXCJ0aW1lLW1hcmstbm90aWNlLW1vZGFsXCIsIHRydWUpO1xuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIlRpbWUgRm9ybWF0IGZvciB0aW1lIGNvdW50ZXJcIiwgY2xzOiBcInRpbWUtY291bnRlci1tb2RhbC10aXRsZVwiIH0pO1xuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIiwge1xuICAgICAgICAgICAgdGV4dDogXCJEZWZhdWx0IHRpbWUgZm9ybWF0IGlzIFlZWVlNTURESEhtbXNzLiBidXQgeW91IGNhbiBjaGFuZ2UgaXQgaW4gc2V0dGluZ3Mgbm93IVwiLFxuICAgICAgICAgICAgY2xzOiBcInRpbWUtY291bnRlci1ub3RpY2VcIixcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IFwiRG8geW91IHdhbnQgdG8gZ28gdG8gc2V0dGluZ3M/XCIsIGNsczogXCJ0aW1lLWNvdW50ZXItbm90aWNlXCIgfSk7XG5cbiAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJidXR0b24tY29udGFpbmVyXCIgfSk7XG5cbiAgICAgICAgbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpXG4gICAgICAgICAgICAuc2V0Q2xhc3MoXCJnby1zZXR0aW5nc1wiKVxuICAgICAgICAgICAgLnNldFdhcm5pbmcoKVxuICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJHbyB0byBjaGFuZ2VcIilcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNiKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAvL0B0cy1leHBlY3QtZXJyb3IsIHByaXZhdGUgbWV0aG9kXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5vcGVuKCk7XG4gICAgICAgICAgICAgICAgLy9AdHMtZXhwZWN0LWVycm9yLCBwcml2YXRlIG1ldGhvZFxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcub3BlblRhYkJ5SWQoXCJ0aW1lLWNvdW50ZXJcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uQ29udGFpbmVyKVxuICAgICAgICAgICAgLnNldENsYXNzKFwiZG8tbm90LWdvLXNldHRpbmdzXCIpXG4gICAgICAgICAgICAuc2V0QnV0dG9uVGV4dChcIkNvbmZpcm1cIilcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNiKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhc3luYyBvbkNsb3NlKCkge1xuICAgICAgICBzdXBlci5vbkNsb3NlKCk7XG4gICAgICAgIGF3YWl0IHRoaXMuY2IoZmFsc2UpO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIFRpbWVDb3VudGVyU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogVGltZUNvdW50ZXJQbHVnaW47XG4gICAgcmVnaXN0cmF0aW9uOiBSZWdpc3RyYXRpb247XG4gICAgLy9lc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICBwcml2YXRlIGFwcGx5RGVib3VuY2VUaW1lcjogbnVtYmVyID0gMDtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCByZWdpc3RyYXRpb246IFJlZ2lzdHJhdGlvbiwgcGx1Z2luOiBUaW1lQ291bnRlclBsdWdpbikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLnJlZ2lzdHJhdGlvbiA9IHJlZ2lzdHJhdGlvbjtcbiAgICB9XG5cbiAgICBhcHBseVNldHRpbmdzVXBkYXRlKCkge1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5hcHBseURlYm91bmNlVGltZXIpO1xuICAgICAgICBjb25zdCBwbHVnaW4gPSB0aGlzLnBsdWdpbjtcbiAgICAgICAgdGhpcy5hcHBseURlYm91bmNlVGltZXIgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBwbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0sIDEwMCk7XG4gICAgfVxuXG4gICAgYXN5bmMgaGlkZSgpIHt9XG5cbiAgICBhc3luYyBkaXNwbGF5KCkge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgY29uc3QgZGVzYyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgZGVzYy5hcHBlbmQoXG4gICAgICAgICAgICBcIlVzZSBcIixcbiAgICAgICAgICAgIGNyZWF0ZUVsKFwiYVwiLCB7IGhyZWY6IFwiaHR0cHM6Ly9tb21lbnRqcy5jb20vZG9jcy8jL2Rpc3BsYXlpbmcvXCIgfSwgKGVsKSA9PiB7XG4gICAgICAgICAgICAgICAgZWwuaW5uZXJUZXh0ID0gXCJNb21lbnQuanMgZm9ybWF0XCI7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIFwiIHRvIGN1c3RvbWl6ZSB0aGUgdGltZSBmb3JtYXQuIFwiLFxuICAgICAgICAgICAgY3JlYXRlRWwoXCJzcGFuXCIsIHtcbiAgICAgICAgICAgICAgICB0ZXh0OiBcIlBsZWFzZSByZWxvYWQgT2JzaWRpYW4gYWZ0ZXIgY2hhbmdpbmcgdGhlIGZvcm1hdC5cIixcbiAgICAgICAgICAgICAgICBjbHM6IFwidGltZS1jb3VudGVyLWRlc2NcIixcbiAgICAgICAgICAgIH0pLFxuICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJUaW1lIEZvcm1hdFwiKVxuICAgICAgICAgICAgLy8gVXNpbmcgRG9jdW1lbnRGcmFnbWVudCB0byBzdXBwb3J0IGEgbGluayBpbiBkZXNjcmlwdGlvblxuICAgICAgICAgICAgLnNldERlc2MoZGVzYylcbiAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG4gICAgICAgICAgICAgICAgdGV4dC5zZXRQbGFjZWhvbGRlcihERUZBVUxUX1NFVFRJTkdTLnRpbWVGb3JtYXQpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50aW1lRm9ybWF0KVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50aW1lRm9ybWF0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGx5U2V0dGluZ3NVcGRhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmNoZWNrUHJvKGNvbnRhaW5lckVsKTtcbiAgICB9XG5cbiAgICBhc3luYyBjaGVja1Bybyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgbWFjaGluZUNvZGUgPSBhd2FpdCB0aGlzLnJlZ2lzdHJhdGlvbi5nZXRNYWNoaW5lQ29kZSgpO1xuICAgICAgICBjb25zdCBzdGF0dXMgPSBhd2FpdCB0aGlzLnJlZ2lzdHJhdGlvbi5jaGVja1N0YXR1cyhtYWNoaW5lQ29kZSk7XG5cbiAgICAgICAgaWYgKHN0YXR1cykge1xuICAgICAgICAgICAgaWYgKEpTT04ucGFyc2Uoc3RhdHVzKS5tZXNzYWdlID09PSBcInN1Y2NlZWRcIikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyeURhdGUgPSBKU09OLnBhcnNlKHN0YXR1cykuZXhwaXJ5RGF0ZTtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9TdGF0dXNEZXNjID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICAgICAgICAgIHByb1N0YXR1c0Rlc2MuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICBcIllvdSBoYXZlIHB1cmNoYXNlZCB0aGUgVGltZS1Db3VudGVyIFBybyB2ZXJzaW9uLCB3aXRoIGFuIGFjdGl2YXRpb24gZGF0ZSB1bnRpbCBcIixcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlRWwoXCJzcGFuXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1vbWVudChleHBpcnlEYXRlLCBcIllZWVlNTUREXCIpLmZvcm1hdChcIllZWVktTU0tRERcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICBjbHM6IFwidGltZS1jb3VudGVyLWRlc2NcIixcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgIFwiLiBcIixcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiVmVyc2lvbiBTdGF0dXNcIikuc2V0RGVzYyhwcm9TdGF0dXNEZXNjKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzdGF0dXNEZXNjID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICBzdGF0dXNEZXNjLmFwcGVuZChcbiAgICAgICAgICAgIFwiUGxlYXNlIGVudGVyIHRoZSByZWdpc3RlciBjb2RlIHRvIGFjdGl2YXRlIHRoZSBwcm8gdmVyc2lvbi4gXCIsXG4gICAgICAgICAgICBjcmVhdGVFbChcInNwYW5cIiwge1xuICAgICAgICAgICAgICAgIHRleHQ6IFwiUGxlYXNlIHJlbG9hZCBPYnNpZGlhbiBhZnRlciBjaGFuZ2luZyB0aGUgcmVnaXN0ZXIgY29kZS5cIixcbiAgICAgICAgICAgICAgICBjbHM6IFwidGltZS1jb3VudGVyLWRlc2NcIixcbiAgICAgICAgICAgIH0pLFxuICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJSZWdpc3RlciBDb2RlXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhzdGF0dXNEZXNjKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbigoYnV0dG9uKSA9PiB7XG4gICAgICAgICAgICAgICAgYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiQWN0aXZhdGVcIilcbiAgICAgICAgICAgICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlZ0NvZGUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWdDb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlZ0NvZGUgPT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiUGxlYXNlIGVudGVyIHRoZSByZWdpc3RlciBjb2RlIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtYWNoaW5lQ29kZSA9IGF3YWl0IHRoaXMucmVnaXN0cmF0aW9uLmdldE1hY2hpbmVDb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGF0dXMgPSBhd2FpdCB0aGlzLnJlZ2lzdHJhdGlvbi5jaGVja1N0YXR1cyhtYWNoaW5lQ29kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEpTT04ucGFyc2Uoc3RhdHVzKS5tZXNzYWdlID09PSBcInN1Y2NlZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWdDb2RlID0gSlNPTi5wYXJzZShzdGF0dXMpLnJlZ0NvZGUgfHwgcmVnQ29kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBseVNldHRpbmdzVXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpTT04ucGFyc2Uoc3RhdHVzKS5yZWdDb2RlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb21lbnQoSlNPTi5wYXJzZShzdGF0dXMpLmV4cGlyeURhdGUsIFwiWVlZWU1NRERcIikuaXNBZnRlcihtb21lbnQoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckVkaXRvckV4dGVuc2lvbihbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxheVdpZGdldFBsdWdpbih0aGlzLmFwcCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRlclBsdWdpbih0aGlzLmFwcCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlVGFza1RpbWVNYXJrUGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2Jvb2tGaWVsZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dib29rRGVjb3JhdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKChlbCwgY3R4KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0VGV4dEluRWxlbWVudCh0aGlzLmFwcCwgZWwsIHJ1bGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVMb2dib29rVGltZU1hcmtJblByZXZpZXdNb2RlKGVsLCBpbml0TG9nYm9va1RpbWVDb3VudGVyTWFyayk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiQWN0aXZhdGlvbiBzdWNjZWVkZWQhXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJBY3RpdmF0aW9uIGZhaWxlZCFcIik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG4gICAgICAgICAgICAgICAgdGV4dC5zZXRQbGFjZWhvbGRlcihERUZBVUxUX1NFVFRJTkdTLnJlZ0NvZGUpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWdDb2RlKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWdDb2RlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGx5U2V0dGluZ3NVcGRhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHtcbiAgICBEZWNvcmF0aW9uLFxuICAgIERlY29yYXRpb25TZXQsXG4gICAgRWRpdG9yVmlldyxcbiAgICBNYXRjaERlY29yYXRvcixcbiAgICBWaWV3UGx1Z2luLFxuICAgIFZpZXdVcGRhdGUsXG4gICAgV2lkZ2V0VHlwZSxcbn0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7IEFwcCwgQnV0dG9uQ29tcG9uZW50LCBlZGl0b3JMaXZlUHJldmlld0ZpZWxkLCBNZW51LCBNb2RhbCwgVGV4dENvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgaW5pdEJ1dHRvbiB9IGZyb20gXCIuLi91dGlscy9idXR0b25cIjtcblxuZXhwb3J0IHR5cGUgTWFya1R5cGUgPSBcInN0YXJ0XCIgfCBcImVuZFwiO1xuXG5jbGFzcyBDb3VudGVyTWFya1dpZGdldCBleHRlbmRzIFdpZGdldFR5cGUge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICByZWFkb25seSBhcHA6IEFwcCxcbiAgICAgICAgcmVhZG9ubHkgdmlldzogRWRpdG9yVmlldyxcbiAgICAgICAgcmVhZG9ubHkgZnJvbTogbnVtYmVyLFxuICAgICAgICByZWFkb25seSB0bzogbnVtYmVyLFxuICAgICAgICByZWFkb25seSBtYXJrVHlwZTogTWFya1R5cGUgPSBcInN0YXJ0XCIsXG4gICAgICAgIHJlYWRvbmx5IHRpbWVTdHJpbmc6IHN0cmluZyxcbiAgICApIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG5cbiAgICBlcShvdGhlcjogQ291bnRlck1hcmtXaWRnZXQpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIG90aGVyLnZpZXcgPT09IHRoaXMudmlldyAmJlxuICAgICAgICAgICAgb3RoZXIuZnJvbSA9PT0gdGhpcy5mcm9tICYmXG4gICAgICAgICAgICBvdGhlci50byA9PT0gdGhpcy50byAmJlxuICAgICAgICAgICAgb3RoZXIudGltZVN0cmluZyA9PT0gdGhpcy50aW1lU3RyaW5nXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgdG9ET00oKSB7XG4gICAgICAgIGNvbnN0IHsgY291bnRlckVsLCBpY29uRWwgfSA9IGluaXRCdXR0b24odGhpcy5hcHAsIHRoaXMudGltZVN0cmluZywgdGhpcy5tYXJrVHlwZSk7XG4gICAgICAgIGljb25FbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbWVudSA9IG5ldyBNZW51KCk7XG4gICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJhY3Rpb25cIilcbiAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKFwiRWRpdCBUaW1lXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwicGVuY2lsXCIpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBUaW1lQ291bnRlck1vZGFsKHRoaXMuYXBwLCB0aGlzLnRpbWVTdHJpbmcsIGFzeW5jIChyZXBsYWNlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXcuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiB0aGlzLmZyb20sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bzogdGhpcy50byxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc2VydDogYFske3RoaXMubWFya1R5cGV9OjpgICsgcmVwbGFjZSArIFwiXVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkub3BlbigpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmFkZEl0ZW0oKGl0ZW0pID0+XG4gICAgICAgICAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShcIlJlbW92ZVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldEljb24oXCJ4XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3LmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogdGhpcy5mcm9tLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG86IHRoaXMudG8sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnQ6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgLnNob3dBdE1vdXNlRXZlbnQoZXZ0KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGNvdW50ZXJFbDtcbiAgICB9XG5cbiAgICBpZ25vcmVFdmVudChldmVudDogRXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvdW50ZXJQbHVnaW4oYXBwOiBBcHApIHtcbiAgICByZXR1cm4gVmlld1BsdWdpbi5mcm9tQ2xhc3MoXG4gICAgICAgIGNsYXNzIHtcbiAgICAgICAgICAgIGRlY29yYXRpb25zOiBEZWNvcmF0aW9uU2V0ID0gRGVjb3JhdGlvbi5ub25lO1xuICAgICAgICAgICAgbWF0Y2hEZWNvcmF0b3I6IE1hdGNoRGVjb3JhdG9yO1xuXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcihwdWJsaWMgdmlldzogRWRpdG9yVmlldykge1xuICAgICAgICAgICAgICAgIHRoaXMubWF0Y2hEZWNvcmF0b3IgPSBuZXcgTWF0Y2hEZWNvcmF0b3Ioe1xuICAgICAgICAgICAgICAgICAgICByZWdleHA6IC9cXEJcXFsoc3RhcnR8ZW5kKTo6KFteXFxdXSopXFxdXFxCL2csXG4gICAgICAgICAgICAgICAgICAgIGRlY29yYXRpb246IHRoaXMuZ2V0RGVjby5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSB0aGlzLm1hdGNoRGVjb3JhdG9yLmNyZWF0ZURlY28odmlldyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGdldERlY28obWF0Y2g6IFJlZ0V4cEV4ZWNBcnJheSwgX3ZpZXc6IEVkaXRvclZpZXcsIHBvczogbnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZnJvbSA9IHBvcztcbiAgICAgICAgICAgICAgICBjb25zdCB0byA9IHBvcyArIG1hdGNoWzBdLmxlbmd0aDtcbiAgICAgICAgICAgICAgICByZXR1cm4gRGVjb3JhdGlvbi5yZXBsYWNlKHtcbiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0OiBuZXcgQ291bnRlck1hcmtXaWRnZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICBhcHAsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXcsXG4gICAgICAgICAgICAgICAgICAgICAgICBmcm9tLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG8sXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaFsxXSA9PT0gXCJzdGFydFwiID8gXCJzdGFydFwiIDogXCJlbmRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoWzJdLFxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB1cGRhdGUodXBkYXRlOiBWaWV3VXBkYXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF1cGRhdGUuc3RhdGUuZmllbGQoZWRpdG9yTGl2ZVByZXZpZXdGaWVsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWNvcmF0aW9ucyA9IERlY29yYXRpb24ubm9uZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh1cGRhdGUuc3RhdGUuZmllbGQoZWRpdG9yTGl2ZVByZXZpZXdGaWVsZCkgIT09IHVwZGF0ZS5zdGFydFN0YXRlLmZpZWxkKGVkaXRvckxpdmVQcmV2aWV3RmllbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSB0aGlzLm1hdGNoRGVjb3JhdG9yLmNyZWF0ZURlY28odXBkYXRlLnZpZXcpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5kZWNvcmF0aW9ucyA9IHRoaXMubWF0Y2hEZWNvcmF0b3IudXBkYXRlRGVjbyh1cGRhdGUsIHRoaXMuZGVjb3JhdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBkZWNvcmF0aW9uczogKHYpID0+IHYuZGVjb3JhdGlvbnMsXG4gICAgICAgICAgICBwcm92aWRlOiAocGx1Z2luKSA9PlxuICAgICAgICAgICAgICAgIEVkaXRvclZpZXcuYXRvbWljUmFuZ2VzLm9mKCh2aWV3KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2aWV3LnBsdWdpbihwbHVnaW4pPy5kZWNvcmF0aW9ucyB8fCBEZWNvcmF0aW9uLm5vbmU7XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgIH0sXG4gICAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxpbmVFbmRXaWRnZXRQbHVnaW4oYXBwOiBBcHApIHtcbiAgICByZXR1cm4gVmlld1BsdWdpbi5mcm9tQ2xhc3MoXG4gICAgICAgIGNsYXNzIHtcbiAgICAgICAgICAgIGRlY29yYXRpb25zOiBEZWNvcmF0aW9uU2V0ID0gRGVjb3JhdGlvbi5ub25lO1xuICAgICAgICAgICAgbWF0Y2hEZWNvcmF0b3I6IE1hdGNoRGVjb3JhdG9yO1xuXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcihwdWJsaWMgdmlldzogRWRpdG9yVmlldykge1xuICAgICAgICAgICAgICAgIHRoaXMubWF0Y2hEZWNvcmF0b3IgPSBuZXcgTWF0Y2hEZWNvcmF0b3Ioe1xuICAgICAgICAgICAgICAgICAgICByZWdleHA6IC9cXEJcXFsoc3RhcnR8ZW5kKTo6KFteXFxdXSopXFxdXFxCL2csXG4gICAgICAgICAgICAgICAgICAgIGRlY29yYXRpb246IHRoaXMuZ2V0RGVjby5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSB0aGlzLm1hdGNoRGVjb3JhdG9yLmNyZWF0ZURlY28odmlldyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGdldERlY28obWF0Y2g6IFJlZ0V4cEV4ZWNBcnJheSwgdmlldzogRWRpdG9yVmlldywgcG9zOiBudW1iZXIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lRW5kID0gdmlldy5zdGF0ZS5kb2MubGluZUF0KHBvcykudG87XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gRGVjb3JhdGlvbi5tYXJrKHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbTogbGluZUVuZCxcbiAgICAgICAgICAgICAgICAgICAgdG86IGxpbmVFbmQsXG4gICAgICAgICAgICAgICAgICAgIGFib3ZlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB3aWRnZXQ6IG5ldyBDb3VudGVyTWFya1dpZGdldChcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlldyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcyArIG1hdGNoWzBdLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoWzFdID09PSBcInN0YXJ0XCIgPyBcInN0YXJ0XCIgOiBcImVuZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hbMl0sXG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHVwZGF0ZSh1cGRhdGU6IFZpZXdVcGRhdGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXVwZGF0ZS5zdGF0ZS5maWVsZChlZGl0b3JMaXZlUHJldmlld0ZpZWxkKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlY29yYXRpb25zID0gRGVjb3JhdGlvbi5ub25lO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5kZWNvcmF0aW9ucyA9IHRoaXMubWF0Y2hEZWNvcmF0b3IudXBkYXRlRGVjbyh1cGRhdGUsIHRoaXMuZGVjb3JhdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBkZWNvcmF0aW9uczogKHYpID0+IHYuZGVjb3JhdGlvbnMsXG4gICAgICAgICAgICBwcm92aWRlOiAocGx1Z2luKSA9PlxuICAgICAgICAgICAgICAgIEVkaXRvclZpZXcuYXRvbWljUmFuZ2VzLm9mKCh2aWV3KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2aWV3LnBsdWdpbihwbHVnaW4pPy5kZWNvcmF0aW9ucyB8fCBEZWNvcmF0aW9uLm5vbmU7XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgIH0sXG4gICAgKTtcbn1cblxuY2xhc3MgVGltZUNvdW50ZXJNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwcml2YXRlIGNiOiAocmVwbGFjZTogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+O1xuICAgIHByaXZhdGUgY3VycmVudFZhbHVlOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgdmFsdWU6IHN0cmluZywgY2I6IChyZXBsYWNlOiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD4pIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5jYiA9IGNiO1xuICAgICAgICB0aGlzLmN1cnJlbnRWYWx1ZSA9IHZhbHVlO1xuICAgIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgbGV0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwudG9nZ2xlQ2xhc3MoXCJ0aW1lLW1hcmstYXNrLW1vZGFsXCIsIHRydWUpO1xuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIkNoYW5nZSBUaW1lXCIgfSk7XG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiYnV0dG9uLWNvbnRhaW5lclwiIH0pO1xuXG4gICAgICAgIGNvbnN0IHRleHRDb21wb25lbnQgPSBuZXcgVGV4dENvbXBvbmVudChidXR0b25Db250YWluZXIpO1xuICAgICAgICB0ZXh0Q29tcG9uZW50LnNldFZhbHVlKHRoaXMuY3VycmVudFZhbHVlKTtcbiAgICAgICAgdGV4dENvbXBvbmVudC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFZhbHVlID0gdmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXRDbGFzcyhcImRvLW5vdC1yZW1vdmVcIilcbiAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiT0tcIilcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmNiKHRoaXMuY3VycmVudFZhbHVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBFeHRyYUJ1dHRvbkNvbXBvbmVudCwgbW9tZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBNYXJrVHlwZSB9IGZyb20gXCIuLi93aWRnZXRzL2NvdW50ZXJXaWRnZXRcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRCdXR0b24oYXBwOiBBcHAsIHRpbWVTdHJpbmc6IHN0cmluZywgbWFya1R5cGU6IE1hcmtUeXBlKSB7XG4gICAgY29uc3QgY291bnRlckVsID0gY3JlYXRlU3BhbihcImNtLXRpbWUtY291bnRlci1pY29uXCIpO1xuICAgIGNvbnN0IGRhdGVGb3JtYXQgPSBhcHAucGx1Z2lucy5nZXRQbHVnaW4oXCJ0aW1lLWNvdW50ZXJcIikuc2V0dGluZ3MudGltZUZvcm1hdC50cmltKCk7XG4gICAgY29uc3QgcGFyc2VkVGltZUZvcm1hdCA9ICFkYXRlRm9ybWF0ICYmIGRhdGVGb3JtYXQ/Lmxlbmd0aCA9PT0gMCA/IFwiWVlZWU1NRERISG1tc3NcIiA6IGRhdGVGb3JtYXQ7XG4gICAgY29uc3QgaWNvbkVsID0gY291bnRlckVsLmNyZWF0ZVNwYW4obWFya1R5cGUgPT09IFwic3RhcnRcIiA/IFwidGltZS1jb3VudGVyLXN0YXJ0XCIgOiBcInRpbWUtY291bnRlci1lbmRcIik7XG5cbiAgICBjb25zdCBidXR0b24gPSBuZXcgRXh0cmFCdXR0b25Db21wb25lbnQoaWNvbkVsKTtcblxuICAgIGxldCB0aXRsZTogc3RyaW5nLCBpY29uOiBzdHJpbmc7XG4gICAgaWYgKG1hcmtUeXBlID09PSBcInN0YXJ0XCIpIHtcbiAgICAgICAgdGl0bGUgPSBcIlJlbW92ZSBUaW1lIENvdW50ZXIgU3RhcnQgTWFya1wiO1xuICAgICAgICBpY29uID0gXCJyYWJiaXRcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aXRsZSA9IFwiUmVtb3ZlIFRpbWUgQ291bnRlciBFbmQgTWFya1wiO1xuICAgICAgICBpY29uID0gXCJ0dXJ0bGVcIjtcbiAgICB9XG4gICAgYnV0dG9uLnNldEljb24oaWNvbik7XG4gICAgYnV0dG9uLnNldFRvb2x0aXAobW9tZW50KHRpbWVTdHJpbmcsIHBhcnNlZFRpbWVGb3JtYXQpLmZvcm1hdChcIllZWVktTU0tREQgSEg6bW06c3NcIikpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvdW50ZXJFbCxcbiAgICAgICAgaWNvbkVsLFxuICAgIH07XG59XG4iLCAiaW1wb3J0IHsgRGVjb3JhdGlvbiwgRGVjb3JhdGlvblNldCwgRWRpdG9yVmlldywgVmlld1BsdWdpbiwgVmlld1VwZGF0ZSwgV2lkZ2V0VHlwZSB9IGZyb20gXCJAY29kZW1pcnJvci92aWV3XCI7XHJcbmltcG9ydCB7IEFwcCwgbW9tZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IFJhbmdlU2V0QnVpbGRlciB9IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xyXG5pbXBvcnQgeyBpbml0SW5saW5lVGltZUNvdW50ZXJNYXJrIH0gZnJvbSBcIi4uL3V0aWxzL2RvbVV0aWxzXCI7XHJcbmltcG9ydCB7IGZvcm1hdER1cmF0aW9uIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNUaW1lTWFya0FycmF5KHRpbWU6IFRpbWVNYXJrIHwgVGltZU1hcmtbXSk6IHRpbWUgaXMgVGltZU1hcmtbXSB7XHJcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh0aW1lKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZU11bHRpVGltZShhcHA6IEFwcCwgdGltZTogVGltZU1hcmtbXSkge1xyXG4gICAgY29uc3QgZGF0ZUZvcm1hdCA9IGFwcC5wbHVnaW5zLmdldFBsdWdpbihcInRpbWUtY291bnRlclwiKS5zZXR0aW5ncy50aW1lRm9ybWF0LnRyaW0oKTtcclxuICAgIGNvbnN0IHBhcnNlZFRpbWVGb3JtYXQgPSAhZGF0ZUZvcm1hdCAmJiBkYXRlRm9ybWF0Py5sZW5ndGggPT09IDAgPyBcIllZWVlNTURESEhtbXNzXCIgOiBkYXRlRm9ybWF0O1xyXG4gICAgbGV0IHRvdGFsRHVyYXRpb246IER1cmF0aW9uID0ge1xyXG4gICAgICAgIGRheXM6IDAsXHJcbiAgICAgICAgaG91cnM6IDAsXHJcbiAgICAgICAgbWludXRlczogMCxcclxuICAgICAgICBzZWNvbmRzOiAwLFxyXG4gICAgfTtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRpbWUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBzdGFydE1vbWVudCA9IG1vbWVudCh0aW1lW2ldLnRpbWVTdGFydCwgcGFyc2VkVGltZUZvcm1hdCk7XHJcbiAgICAgICAgY29uc3QgZW5kTW9tZW50ID0gbW9tZW50KHRpbWVbaV0udGltZUVuZCwgcGFyc2VkVGltZUZvcm1hdCk7XHJcbiAgICAgICAgY29uc3QgZHVyYXRpb24gPSBmb3JtYXREdXJhdGlvbihzdGFydE1vbWVudCwgZW5kTW9tZW50KTtcclxuICAgICAgICB0b3RhbER1cmF0aW9uLmRheXMgKz0gZHVyYXRpb24uZGF5cztcclxuICAgICAgICB0b3RhbER1cmF0aW9uLmhvdXJzICs9IGR1cmF0aW9uLmhvdXJzO1xyXG4gICAgICAgIHRvdGFsRHVyYXRpb24ubWludXRlcyArPSBkdXJhdGlvbi5taW51dGVzO1xyXG4gICAgICAgIHRvdGFsRHVyYXRpb24uc2Vjb25kcyArPSBkdXJhdGlvbi5zZWNvbmRzO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0b3RhbER1cmF0aW9uO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlU2luZ2xlVGltZShhcHA6IEFwcCwgdGltZTogVGltZU1hcmspIHtcclxuICAgIGNvbnN0IGRhdGVGb3JtYXQgPSBhcHAucGx1Z2lucy5nZXRQbHVnaW4oXCJ0aW1lLWNvdW50ZXJcIikuc2V0dGluZ3MudGltZUZvcm1hdC50cmltKCk7XHJcbiAgICBjb25zdCBwYXJzZWRUaW1lRm9ybWF0ID0gIWRhdGVGb3JtYXQgJiYgZGF0ZUZvcm1hdD8ubGVuZ3RoID09PSAwID8gXCJZWVlZTU1EREhIbW1zc1wiIDogZGF0ZUZvcm1hdDtcclxuXHJcbiAgICBjb25zdCBzdGFydCA9IG1vbWVudCh0aW1lLnRpbWVTdGFydCwgcGFyc2VkVGltZUZvcm1hdCk7XHJcbiAgICBjb25zdCBlbmQgPSBtb21lbnQodGltZS50aW1lRW5kLCBwYXJzZWRUaW1lRm9ybWF0KTtcclxuXHJcbiAgICBpZiAoIXN0YXJ0LmlzVmFsaWQoKSB8fCAhZW5kLmlzVmFsaWQoKSkgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgcmV0dXJuIGZvcm1hdER1cmF0aW9uKHN0YXJ0LCBlbmQpO1xyXG59XHJcblxyXG5jbGFzcyBUaW1lTWFya1dpZGdldCBleHRlbmRzIFdpZGdldFR5cGUge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcmVhZG9ubHkgYXBwOiBBcHAsXHJcbiAgICAgICAgcmVhZG9ubHkgdmlldzogRWRpdG9yVmlldyxcclxuICAgICAgICByZWFkb25seSBmcm9tOiBudW1iZXIsXHJcbiAgICAgICAgcmVhZG9ubHkgdG86IG51bWJlcixcclxuICAgICAgICByZWFkb25seSB0aW1lOiBUaW1lTWFyayB8IFRpbWVNYXJrW10sXHJcbiAgICApIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIGVxKG90aGVyOiBUaW1lTWFya1dpZGdldCkge1xyXG4gICAgICAgIHJldHVybiBvdGhlci52aWV3ID09PSB0aGlzLnZpZXcgJiYgb3RoZXIuZnJvbSA9PT0gdGhpcy5mcm9tICYmIG90aGVyLnRvID09PSB0aGlzLnRvICYmIG90aGVyLnRpbWUgPT09IHRoaXMudGltZTtcclxuICAgIH1cclxuXHJcbiAgICB0b0RPTSgpIHtcclxuICAgICAgICBjb25zdCBpc011bHRpID0gaXNUaW1lTWFya0FycmF5KHRoaXMudGltZSk7XHJcbiAgICAgICAgbGV0IHRpbWVTdHJpbmc6IER1cmF0aW9uIHwgbnVsbCA9IGlzTXVsdGlcclxuICAgICAgICAgICAgPyBjYWxjdWxhdGVNdWx0aVRpbWUodGhpcy5hcHAsIHRoaXMudGltZSBhcyBUaW1lTWFya1tdKVxyXG4gICAgICAgICAgICA6IGNhbGN1bGF0ZVNpbmdsZVRpbWUodGhpcy5hcHAsIHRoaXMudGltZSBhcyBUaW1lTWFyayk7XHJcblxyXG4gICAgICAgIGlmICghdGltZVN0cmluZykge1xyXG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlU3BhbihcImNtLXRpbWUtbWFyay1pY29uXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGluaXRJbmxpbmVUaW1lQ291bnRlck1hcmsodGltZVN0cmluZyk7XHJcbiAgICB9XHJcblxyXG4gICAgaWdub3JlRXZlbnQoZXZlbnQ6IEV2ZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRDb3VudGVyRGVjb3MoYXBwOiBBcHAsIHZpZXc6IEVkaXRvclZpZXcpIHtcclxuICAgIGNvbnN0IGJ1aWxkZXIgPSBuZXcgUmFuZ2VTZXRCdWlsZGVyPERlY29yYXRpb24+KCk7XHJcbiAgICBjb25zdCBzZWVuOiBTZXQ8bnVtYmVyPiA9IG5ldyBTZXQoKTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IHsgZnJvbSwgdG8gfSBvZiB2aWV3LnZpc2libGVSYW5nZXMpIHtcclxuICAgICAgICBmb3IgKGxldCBwb3MgPSBmcm9tOyBwb3MgPD0gdG87ICkge1xyXG4gICAgICAgICAgICBjb25zdCBsaW5lID0gdmlldy5zdGF0ZS5kb2MubGluZUF0KHBvcyk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBbLi4ubGluZS50ZXh0Lm1hdGNoQWxsKC9cXEJcXFtzdGFydDo6KFteXFxdXSopXFxdXFxCKC4qPylcXEJcXFtlbmQ6OihbXlxcXV0qKVxcXVxcQi9nKV07XHJcblxyXG4gICAgICAgICAgICBpZiAobWF0Y2hlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVNYXJrczogVGltZU1hcmtbXSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBtYXRjaCBvZiBtYXRjaGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlZW4uaGFzKGxpbmUuZnJvbSkgJiYgbWF0Y2hlcy5sZW5ndGggPT09IDEpIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlZW4uYWRkKGxpbmUuZnJvbSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVTdGFydCA9IG1hdGNoWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVFbmQgPSBtYXRjaFszXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZU1hcmtzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lU3RhcnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVFbmQsXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgYnVpbGRlci5hZGQoXHJcbiAgICAgICAgICAgICAgICAgICAgbGluZS50byxcclxuICAgICAgICAgICAgICAgICAgICBsaW5lLnRvLFxyXG4gICAgICAgICAgICAgICAgICAgIERlY29yYXRpb24ud2lkZ2V0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0OiBuZXcgVGltZU1hcmtXaWRnZXQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZS50byxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVNYXJrcy5sZW5ndGggPiAxID8gdGltZU1hcmtzIDogdGltZU1hcmtzWzBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaWRlOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcG9zID0gbGluZS50byArIDE7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBidWlsZGVyLmZpbmlzaCgpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgbGluZUVuZFdpZGdldFBsdWdpbiA9IChhcHA6IEFwcCkgPT4ge1xyXG4gICAgcmV0dXJuIFZpZXdQbHVnaW4uZnJvbUNsYXNzKFxyXG4gICAgICAgIGNsYXNzIHtcclxuICAgICAgICAgICAgZGVjb3JhdGlvbnM6IERlY29yYXRpb25TZXQ7XHJcblxyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih2aWV3OiBFZGl0b3JWaWV3KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlY29yYXRpb25zID0gYnVpbGRDb3VudGVyRGVjb3MoYXBwLCB2aWV3KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHVwZGF0ZS5kb2NDaGFuZ2VkIHx8IHVwZGF0ZS52aWV3cG9ydENoYW5nZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlY29yYXRpb25zID0gYnVpbGRDb3VudGVyRGVjb3MoYXBwLCB1cGRhdGUudmlldyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZGVjb3JhdGlvbnM6ICh2KSA9PiB2LmRlY29yYXRpb25zLFxyXG4gICAgICAgIH0sXHJcbiAgICApO1xyXG59O1xyXG4iLCAiaW1wb3J0IHsgaW5pdEJ1dHRvbiB9IGZyb20gXCIuL2J1dHRvblwiO1xuaW1wb3J0IHsgQXBwLCBtb21lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IE1hcmtUeXBlIH0gZnJvbSBcIi4uL3dpZGdldHMvY291bnRlcldpZGdldFwiO1xuaW1wb3J0IHsgY2xvY2tMaW5lUmVnZXggfSBmcm9tIFwiLi4vY29uc3RcIjtcbmltcG9ydCB7IGNhbGN1bGF0ZUxlbmd0aCwgZm9ybWF0RHVyYXRpb24sIGZvcm1hdER1cmF0aW9uVmlhU3RyaW5nLCB1cGRhdGVUaW1lRWwgfSBmcm9tIFwiLi91dGlsc1wiO1xuaW1wb3J0IHsgY2FsY3VsYXRlTXVsdGlUaW1lLCBjYWxjdWxhdGVTaW5nbGVUaW1lLCBpc1RpbWVNYXJrQXJyYXkgfSBmcm9tIFwiLi4vd2lkZ2V0cy9saW5lTWFya1dpZGdldFwiO1xuXG5pbnRlcmZhY2UgSGlnaGxpZ2h0UnVsZSB7XG4gICAgcmVnZXhQYXR0ZXJuOiBzdHJpbmc7XG4gICAgY3JlYXRvcjogUmVwbGFjZW1lbnRFbGVtZW50Q3JlYXRvcjtcbn1cblxudHlwZSBSZXBsYWNlbWVudEVsZW1lbnRDcmVhdG9yID0gKGFwcDogQXBwLCBtYXRjaGVkVGV4dDogc3RyaW5nKSA9PiBIVE1MRWxlbWVudDtcblxuY29uc3QgVElNRV9NQVJLX1JFR0VYID0gXCJcXFxcWyhzdGFydHxlbmQpOjooW15cXFxcXV0qKVxcXFxdXCI7XG5cbmZ1bmN0aW9uIHNwbGl0VGltZVN0cmluZyh0aW1lOiBzdHJpbmcpIHtcbiAgICBjb25zdCBtYXJrVHlwZSA9IHRpbWUubWF0Y2goVElNRV9NQVJLX1JFR0VYKT8uWzFdIGFzIE1hcmtUeXBlO1xuICAgIGNvbnN0IHRpbWVTdHJpbmcgPSB0aW1lLm1hdGNoKFRJTUVfTUFSS19SRUdFWCk/LlsyXTtcbiAgICByZXR1cm4ge1xuICAgICAgICB0aW1lU3RyaW5nLFxuICAgICAgICBtYXJrVHlwZSxcbiAgICB9O1xufVxuXG5leHBvcnQgY29uc3QgcnVsZXM6IEhpZ2hsaWdodFJ1bGVbXSA9IFtcbiAgICB7XG4gICAgICAgIHJlZ2V4UGF0dGVybjogXCIoXFxcXFtzdGFydDo6W15cXFxcXV0qXFxcXF0pXCIsXG4gICAgICAgIGNyZWF0b3I6IChhcHAsIG1hdGNoZWRUZXh0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IHRpbWVTdHJpbmcgfSA9IHNwbGl0VGltZVN0cmluZyhtYXRjaGVkVGV4dCk7XG4gICAgICAgICAgICBpZiAoIXRpbWVTdHJpbmcpIHJldHVybiBjcmVhdGVTcGFuKFwiY20tdGltZS1jb3VudGVyLWljb25cIik7XG4gICAgICAgICAgICBjb25zdCB7IGNvdW50ZXJFbCB9ID0gaW5pdEJ1dHRvbihhcHAsIHRpbWVTdHJpbmcsIFwic3RhcnRcIik7XG4gICAgICAgICAgICByZXR1cm4gY291bnRlckVsO1xuICAgICAgICB9LFxuICAgIH0sXG4gICAge1xuICAgICAgICByZWdleFBhdHRlcm46IFwiKFxcXFxbZW5kOjpbXlxcXFxdXSpcXFxcXSlcIixcbiAgICAgICAgY3JlYXRvcjogKGFwcCwgbWF0Y2hlZFRleHQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgdGltZVN0cmluZyB9ID0gc3BsaXRUaW1lU3RyaW5nKG1hdGNoZWRUZXh0KTtcbiAgICAgICAgICAgIGlmICghdGltZVN0cmluZykgcmV0dXJuIGNyZWF0ZVNwYW4oXCJjbS10aW1lLWNvdW50ZXItaWNvblwiKTtcbiAgICAgICAgICAgIGNvbnN0IHsgY291bnRlckVsIH0gPSBpbml0QnV0dG9uKGFwcCwgdGltZVN0cmluZywgXCJlbmRcIik7XG4gICAgICAgICAgICByZXR1cm4gY291bnRlckVsO1xuICAgICAgICB9LFxuICAgIH0sXG5dO1xuXG5leHBvcnQgZnVuY3Rpb24gaGlnaGxpZ2h0VGV4dEluRWxlbWVudChhcHA6IEFwcCwgZWxlbWVudDogSFRNTEVsZW1lbnQsIHJ1bGVzOiBIaWdobGlnaHRSdWxlW10pIHtcbiAgICBjb25zdCB3YWxrZXIgPSBkb2N1bWVudC5jcmVhdGVUcmVlV2Fsa2VyKGVsZW1lbnQsIE5vZGVGaWx0ZXIuU0hPV19URVhUKTtcbiAgICBsZXQgbm9kZTtcblxuICAgIGNvbnN0IG5vZGVzVG9Qcm9jZXNzOiBOb2RlW10gPSBbXTtcbiAgICB3aGlsZSAoKG5vZGUgPSB3YWxrZXIubmV4dE5vZGUoKSkpIHtcbiAgICAgICAgbm9kZXNUb1Byb2Nlc3MucHVzaChub2RlKTtcbiAgICB9XG5cbiAgICBub2Rlc1RvUHJvY2Vzcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgIHJlcGxhY2VUZXh0V2l0aEVsZW1lbnRzKGFwcCwgbm9kZSwgcnVsZXMpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiByZXBsYWNlVGV4dFdpdGhFbGVtZW50cyhhcHA6IEFwcCwgbm9kZTogTm9kZSwgcnVsZXM6IEhpZ2hsaWdodFJ1bGVbXSkge1xuICAgIGlmIChub2RlLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSkge1xuICAgICAgICBsZXQgdGV4dENvbnRlbnQgPSBub2RlLnRleHRDb250ZW50IHx8IFwiXCI7XG5cbiAgICAgICAgcnVsZXMuZm9yRWFjaCgocnVsZSkgPT4ge1xuICAgICAgICAgICAgbGV0IG5ld1RleHRDb250ZW50ID0gXCJcIjtcbiAgICAgICAgICAgIGxldCBtYXRjaDtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChydWxlLnJlZ2V4UGF0dGVybiwgXCJnXCIpO1xuICAgICAgICAgICAgbGV0IGxhc3RJbmRleCA9IDA7XG5cbiAgICAgICAgICAgIHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKHRleHRDb250ZW50KSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0ID0gbWF0Y2hbMF07XG4gICAgICAgICAgICAgICAgY29uc3QgcHJlY2VkaW5nVGV4dCA9IHRleHRDb250ZW50LnN1YnN0cmluZyhsYXN0SW5kZXgsIG1hdGNoLmluZGV4KTtcbiAgICAgICAgICAgICAgICBuZXdUZXh0Q29udGVudCArPSBwcmVjZWRpbmdUZXh0O1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnRFbGVtZW50ID0gcnVsZS5jcmVhdG9yKGFwcCwgcGFydCk7XG4gICAgICAgICAgICAgICAgbmV3VGV4dENvbnRlbnQgKz0gYDxzcGFuIGRhdGEtcmVwbGFjZT4ke3JlcGxhY2VtZW50RWxlbWVudC5vdXRlckhUTUx9PC9zcGFuPmA7XG4gICAgICAgICAgICAgICAgbGFzdEluZGV4ID0gcmVnZXgubGFzdEluZGV4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBuZXdUZXh0Q29udGVudCArPSB0ZXh0Q29udGVudC5zdWJzdHJpbmcobGFzdEluZGV4KTtcbiAgICAgICAgICAgIHRleHRDb250ZW50ID0gbmV3VGV4dENvbnRlbnQ7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcbiAgICAgICAgY29uc3QgZG9jID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyh0ZXh0Q29udGVudCwgXCJ0ZXh0L2h0bWxcIik7XG4gICAgICAgIEFycmF5LmZyb20oZG9jLmJvZHkuY2hpbGROb2RlcykuZm9yRWFjaCgobmV3Tm9kZSkgPT4ge1xuICAgICAgICAgICAgaWYgKG5ld05vZGUubm9kZU5hbWUgPT09IFwiU1BBTlwiICYmIChuZXdOb2RlIGFzIEVsZW1lbnQpLmdldEF0dHJpYnV0ZShcImRhdGEtcmVwbGFjZVwiKSkge1xuICAgICAgICAgICAgICAgIEFycmF5LmZyb20obmV3Tm9kZS5jaGlsZE5vZGVzKS5mb3JFYWNoKChjaGlsZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBub2RlLnBhcmVudE5vZGU/Lmluc2VydEJlZm9yZShjaGlsZC5jbG9uZU5vZGUodHJ1ZSksIG5vZGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBub2RlLnBhcmVudE5vZGU/Lmluc2VydEJlZm9yZShuZXdOb2RlLmNsb25lTm9kZSh0cnVlKSwgbm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG5vZGUucGFyZW50Tm9kZT8ucmVtb3ZlQ2hpbGQobm9kZSk7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYXBwZW5kRWxlbWVudFByZXZpZXcoXG4gICAgYXBwOiBBcHAsXG4gICAgZWxlbWVudDogSFRNTEVsZW1lbnQsXG4gICAgY3JlYXRlQUVsZW1lbnQ6ICh0aW1lU3RyaW5nOiBEdXJhdGlvbikgPT4gSFRNTEVsZW1lbnQsXG4pIHtcbiAgICBjb25zdCB0YXNrc1BsdWdpbkVuYWJsZWQgPSBhcHAucGx1Z2lucy5nZXRQbHVnaW4oXCJvYnNpZGlhbi10YXNrcy1wbHVnaW5cIik7XG4gICAgY29uc3Qgc3RhcnRSZWdleCA9IC9cXFsoc3RhcnQ6OihbXlxcXV0qKVxcXSkvO1xuICAgIGNvbnN0IGVuZFJlZ2V4ID0gL1xcWyhlbmQ6OihbXlxcXV0qKVxcXSkvO1xuXG4gICAgY29uc3Qgd2Fsa2VyID0gZG9jdW1lbnQuY3JlYXRlVHJlZVdhbGtlcihlbGVtZW50LCBOb2RlRmlsdGVyLlNIT1dfVEVYVCk7XG4gICAgbGV0IG5vZGU6IE5vZGUgfCBudWxsO1xuICAgIHdoaWxlICgobm9kZSA9IHdhbGtlci5uZXh0Tm9kZSgpKSkge1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gWy4uLm5vZGUudGV4dENvbnRlbnQhLm1hdGNoQWxsKC9cXEJcXFtzdGFydDo6KFteXFxdXSopXFxdXFxCKC4qPylcXEJcXFtlbmQ6OihbXlxcXV0qKVxcXVxcQi9nKV07XG5cbiAgICAgICAgaWYgKG1hdGNoZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCB0aW1lTWFya3M6IFRpbWVNYXJrW10gPSBbXTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbWF0Y2ggb2YgbWF0Y2hlcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVTdGFydCA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVFbmQgPSBtYXRjaFszXTtcblxuICAgICAgICAgICAgICAgIHRpbWVNYXJrcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdGltZVN0YXJ0LFxuICAgICAgICAgICAgICAgICAgICB0aW1lRW5kLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgdGltZTogRHVyYXRpb24gfCBudWxsID0gY2FsY3VsYXRlTXVsdGlUaW1lKGFwcCwgdGltZU1hcmtzIGFzIFRpbWVNYXJrW10pO1xuICAgICAgICAgICAgY29uc3QgbmV3RWxlbWVudCA9IGNyZWF0ZUFFbGVtZW50KHRpbWUpO1xuICAgICAgICAgICAgY29uc3QgcGFyZW50ID0gbm9kZS5wYXJlbnROb2RlO1xuXG4gICAgICAgICAgICBpZiAocGFyZW50Py5ub2RlTmFtZSAhPT0gXCJMSVwiICYmIHRhc2tzUGx1Z2luRW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIGlmIChwYXJlbnQ/LnBhcmVudE5vZGU/Lm5vZGVOYW1lID09PSBcIlNQQU5cIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzcGFuUGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGU/LnBhcmVudE5vZGU/LnBhcmVudE5vZGU/LnBhcmVudE5vZGU7XG4gICAgICAgICAgICAgICAgICAgIChzcGFuUGFyZW50IGFzIEVsZW1lbnQpPy5hcHBlbmRDaGlsZChuZXdFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vIFx1NzUyOCBjb250aW51ZSBcdTY2RkZcdTRFRTMgYnJlYWsgXHU0RUU1XHU3RUU3XHU3RUVEXHU1RkFBXHU3M0FGXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwYXJlbnQ/LmFwcGVuZENoaWxkKG5ld0VsZW1lbnQpO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0SW5saW5lVGltZUNvdW50ZXJNYXJrKHRpbWU6IER1cmF0aW9uKSB7XG4gICAgY29uc3QgY291bnRlckVsID0gY3JlYXRlU3BhbihcImNtLXRpbWUtbWFyay1pY29uXCIpO1xuICAgIGxldCB0aW1lU3RyaW5nID0gdGltZTtcblxuICAgIGNvbnN0IHRpbWVTdHJpbmdXaWR0aCA9IGNhbGN1bGF0ZUxlbmd0aCh0aW1lU3RyaW5nKSAqIDg7XG5cbiAgICBjb25zdCB0aW1lRWwgPSBjb3VudGVyRWwuY3JlYXRlU3Bhbih7XG4gICAgICAgIGNsczogXCJ0aW1lLW1hcmtcIixcbiAgICB9KTtcblxuICAgIHVwZGF0ZVRpbWVFbCh0aW1lRWwsIHRpbWVTdHJpbmcpO1xuXG4gICAgY291bnRlckVsLnN0eWxlLndpZHRoID0gYCR7dGltZVN0cmluZ1dpZHRoICsgMjB9cHhgO1xuXG4gICAgcmV0dXJuIGNvdW50ZXJFbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUxvZ2Jvb2tUaW1lTWFya0luUHJldmlld01vZGUoXG4gICAgZWxlbWVudDogSFRNTEVsZW1lbnQsXG4gICAgY3JlYXRlQUVsZW1lbnQ6IChsb2dib29rQ29udGVudDogc3RyaW5nKSA9PiBIVE1MRWxlbWVudCxcbikge1xuICAgIC8vIFx1NUJGQlx1NjI3RVx1NjI0MFx1NjcwOVx1NTMwNVx1NTQyQiAnOmxvZ2Jvb2s6JyBcdTc2ODRcdTVCNTBcdTgyODJcdTcwQjlcbiAgICBjb25zdCBsb2dib29rTm9kZXM6IE5vZGVbXSA9IFtdO1xuICAgIGNvbnN0IGVuZE5vZGVzOiBOb2RlW10gPSBbXTtcblxuICAgIGNvbnN0IHdhbGtlciA9IGRvY3VtZW50LmNyZWF0ZVRyZWVXYWxrZXIoZWxlbWVudCwgTm9kZUZpbHRlci5TSE9XX1RFWFQpO1xuICAgIGxldCBub2RlOiBOb2RlIHwgbnVsbDtcbiAgICB3aGlsZSAoKG5vZGUgPSB3YWxrZXIubmV4dE5vZGUoKSkpIHtcbiAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFICYmIG5vZGUudGV4dENvbnRlbnQhLmluY2x1ZGVzKFwiOmxvZ2Jvb2s6XCIpKSB7XG4gICAgICAgICAgICBsb2dib29rTm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUgJiYgbm9kZS50ZXh0Q29udGVudCEuaW5jbHVkZXMoXCI6RU5EOlwiKSkge1xuICAgICAgICAgICAgZW5kTm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFx1Nzg2RVx1NEZERFx1NkJDRlx1NEUyQSA6bG9nYm9vazogXHU5MEZEXHU2NzA5XHU0RTAwXHU0RTJBXHU1QkY5XHU1RTk0XHU3Njg0IDpFTkQ6XG4gICAgaWYgKGxvZ2Jvb2tOb2Rlcy5sZW5ndGggIT09IGVuZE5vZGVzLmxlbmd0aCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiTWlzbWF0Y2hlZCA6bG9nYm9vazogYW5kIDpFTkQ6IHBhaXJzLlwiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbG9nYm9va05vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0Tm9kZSA9IGxvZ2Jvb2tOb2Rlc1tpXTtcbiAgICAgICAgY29uc3QgZW5kTm9kZSA9IGVuZE5vZGVzW2ldO1xuXG4gICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IHN0YXJ0Tm9kZTtcbiAgICAgICAgbGV0IGxvZ2Jvb2tDb250ZW50ID0gXCJcIjtcblxuICAgICAgICAvLyBcdTYyOEFcdTYyNDBcdTY3MDlcdTRFQ0UgOmxvZ2Jvb2s6IFx1NTIzMCA6RU5EOiBcdTc2ODRcdTUxODVcdTVCQjlcdTY1MzZcdTk2QzZcdThENzdcdTY3NjVcbiAgICAgICAgd2hpbGUgKGN1cnJlbnROb2RlICYmIGN1cnJlbnROb2RlICE9PSBlbmROb2RlLm5leHRTaWJsaW5nKSB7XG4gICAgICAgICAgICBsb2dib29rQ29udGVudCArPSBjdXJyZW50Tm9kZS50ZXh0Q29udGVudCArIFwiXFxuXCI7XG4gICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLm5leHRTaWJsaW5nIGFzIENoaWxkTm9kZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5ld0VsZW1lbnQgPSBjcmVhdGVBRWxlbWVudChsb2dib29rQ29udGVudCk7XG5cbiAgICAgICAgaWYgKCFuZXdFbGVtZW50KSBjb250aW51ZTtcbiAgICAgICAgaWYgKChlbGVtZW50IGFzIEhUTUxFbGVtZW50KS5ub2RlTmFtZSA9PT0gXCJESVZcIiAmJiAoc3RhcnROb2RlLnBhcmVudE5vZGUgYXMgSFRNTEVsZW1lbnQpLm5vZGVOYW1lID09PSBcIlBcIikge1xuICAgICAgICAgICAgKGVsZW1lbnQuZmlyc3RDaGlsZCBhcyBFbGVtZW50KT8ucHJlcGVuZChuZXdFbGVtZW50KTtcbiAgICAgICAgfSBlbHNlIGlmIChzdGFydE5vZGUucGFyZW50Tm9kZT8ubm9kZU5hbWUgPT09IFwiTElcIikge1xuICAgICAgICAgICAgc3RhcnROb2RlLnBhcmVudE5vZGU/LnByZXBlbmQobmV3RWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0TG9nYm9va1RpbWVDb3VudGVyTWFyayhjb250ZW50OiBzdHJpbmcpIHtcbiAgICBjb25zdCBjb3VudGVyRWwgPSBjcmVhdGVTcGFuKFwiY20tdGltZS1tYXJrLWljb25cIik7XG4gICAgY29uc3QgbGluZXMgPSBjb250ZW50LnRyaW0oKS5zcGxpdChcIlxcblwiKTtcbiAgICBjb25zdCBtYXRjaCA9IGxpbmVzLmZpbHRlcigobGluZSkgPT4gY2xvY2tMaW5lUmVnZXgudGVzdChsaW5lKSk7XG5cbiAgICBpZiAobWF0Y2gubGVuZ3RoID09PSAwKSByZXR1cm4gY291bnRlckVsO1xuXG4gICAgbGV0IHRvdGFsVGltZSA9IG1vbWVudChcIjAwOjAwOjAwXCIsIFwiSEg6bW06c3NcIik7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXRjaC5sZW5ndGg7IGkrKykge1xuICAgICAgICBsZXQgdGltZSA9IG1hdGNoW2ldLm1hdGNoKGNsb2NrTGluZVJlZ2V4KT8uWzJdO1xuICAgICAgICBpZiAodGltZSkge1xuICAgICAgICAgICAgbGV0IGRhdGUgPSBtb21lbnQodGltZSwgXCJISDptbTpzc1wiKTtcbiAgICAgICAgICAgIGlmIChkYXRlLmlzVmFsaWQoKSkge1xuICAgICAgICAgICAgICAgIHRvdGFsVGltZS5hZGQobW9tZW50LmR1cmF0aW9uKHRpbWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBkdXJhdGlvbiA9IGZvcm1hdER1cmF0aW9uKG1vbWVudChcIjAwOjAwOjAwXCIsIFwiSEg6bW06c3NcIiksIHRvdGFsVGltZSk7XG5cbiAgICBjb25zdCBsb2dCb29rRWwgPSBjb3VudGVyRWwuY3JlYXRlU3Bhbih7XG4gICAgICAgIGNsczogXCJ0aW1lLW1hcmtcIixcbiAgICB9KTtcbiAgICBjb25zdCB0aW1lU3RyaW5nV2lkdGggPSBjYWxjdWxhdGVMZW5ndGgoZHVyYXRpb24pICogODtcbiAgICB1cGRhdGVUaW1lRWwobG9nQm9va0VsLCBkdXJhdGlvbik7XG5cbiAgICBjb3VudGVyRWwuc3R5bGUud2lkdGggPSBgJHt0aW1lU3RyaW5nV2lkdGh9cHhgO1xuXG4gICAgcmV0dXJuIGNvdW50ZXJFbDtcbn1cbiIsICIvLyBcdTVCOUFcdTRFNDlcdTRFMDBcdTRFMkEgU3RhdGVFZmZlY3QgXHU2NzY1XHU1OTA0XHU3NDA2XHU2REZCXHU1MkEwXHU1NDhDXHU1MjIwXHU5NjY0XHU2NUY2XHU5NUY0XHU2MjMzXG5leHBvcnQgY29uc3QgdGFza0l0ZW1SZWdleCA9IC8tXFxzXFxbKC4pXFxdL2c7XG5leHBvcnQgY29uc3QgYmxhbmtUYXNrSXRlbVJlZ2V4ID0gLy1cXHNcXFtcXHNcXF0vZztcbmNvbnN0IGRvbmVUYXNrSXRlbVJlZ2V4ID0gLy1cXHNcXFtcXHdcXF0vZztcbi8vIFx1NUI5QVx1NEU0OVx1NEUwMFx1NEUyQVx1NkI2M1x1NTIxOVx1NTMzOVx1OTE0RFx1NjVGNlx1OTVGNFx1NjIzM1xuZXhwb3J0IGNvbnN0IHN0YXJ0VGltZXN0YW1wUmVnZXggPSAvKFxccyk/XFxbc3RhcnQ6OihbXlxcXV0qKVxcXS87XG5leHBvcnQgY29uc3QgZW5kVGltZXN0YW1wUmVnZXggPSAvKFxccyk/XFxbZW5kOjooW15cXF1dKilcXF0vO1xuZXhwb3J0IGNvbnN0IGNsb2NrTGluZVJlZ2V4ID0gL15cXHMqQ0xPQ0s6KC4qKT0+XFxzKihcXGR7Mn06XFxkezJ9OlxcZHsyfSlcXHMqJC87XG4iLCAiaW1wb3J0IHsgQXBwLCBtb21lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgZW5kVGltZXN0YW1wUmVnZXgsIHN0YXJ0VGltZXN0YW1wUmVnZXggfSBmcm9tIFwiLi4vY29uc3RcIjtcclxuaW1wb3J0IHsgTGluZSB9IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVRpbWVFbCh0aW1lRWw6IEhUTUxTcGFuRWxlbWVudCwgdGltZVN0cmluZzogRHVyYXRpb24pIHtcclxuICAgIGlmICh0aW1lU3RyaW5nLmRheXMgPiAwKSB7XHJcbiAgICAgICAgdGltZUVsLmNyZWF0ZVNwYW4oe1xyXG4gICAgICAgICAgICBjbHM6IFwidGltZS1tYXJrLWRheXNcIixcclxuICAgICAgICAgICAgdGV4dDogYCR7dGltZVN0cmluZy5kYXlzfSBkYXlzIGAsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGltZVN0cmluZy5ob3VycyA+IDApIHtcclxuICAgICAgICB0aW1lRWwuY3JlYXRlU3Bhbih7XHJcbiAgICAgICAgICAgIGNsczogXCJ0aW1lLW1hcmstaG91cnNcIixcclxuICAgICAgICAgICAgdGV4dDogYCR7dGltZVN0cmluZy5ob3Vyc30gaHJzIGAsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAodGltZVN0cmluZy5taW51dGVzID4gMCkge1xyXG4gICAgICAgIHRpbWVFbC5jcmVhdGVTcGFuKHtcclxuICAgICAgICAgICAgY2xzOiBcInRpbWUtbWFyay1taW51dGVzXCIsXHJcbiAgICAgICAgICAgIHRleHQ6IGAke3RpbWVTdHJpbmcubWludXRlc30gbWlucyBgLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRpbWVTdHJpbmcuZGF5cyA9PT0gMCAmJiB0aW1lU3RyaW5nLmhvdXJzID09PSAwICYmIHRpbWVTdHJpbmcuc2Vjb25kcyA+PSAwKSB7XHJcbiAgICAgICAgdGltZUVsLmNyZWF0ZVNwYW4oe1xyXG4gICAgICAgICAgICBjbHM6IFwidGltZS1tYXJrLXNlY29uZHNcIixcclxuICAgICAgICAgICAgdGV4dDogYCR7dGltZVN0cmluZy5zZWNvbmRzfSBzZWNzIGAsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBmb3JtYXREdXJhdGlvblZpYVN0cmluZyhhcHA6IEFwcCwgc3RhcnQ6IHN0cmluZywgZW5kOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGRhdGVGb3JtYXQgPSBhcHAucGx1Z2lucy5nZXRQbHVnaW4oXCJ0aW1lLWNvdW50ZXJcIikuc2V0dGluZ3MudGltZUZvcm1hdC50cmltKCk7XHJcbiAgICBjb25zdCBwYXJzZWRUaW1lRm9ybWF0ID0gIWRhdGVGb3JtYXQgJiYgZGF0ZUZvcm1hdD8ubGVuZ3RoID09PSAwID8gXCJZWVlZTU1EREhIbW1zc1wiIDogZGF0ZUZvcm1hdDtcclxuXHJcbiAgICBjb25zdCBzdGFydFRpbWUgPSBtb21lbnQoc3RhcnQsIHBhcnNlZFRpbWVGb3JtYXQpO1xyXG4gICAgY29uc3QgZW5kVGltZSA9IG1vbWVudChlbmQsIHBhcnNlZFRpbWVGb3JtYXQpO1xyXG5cclxuICAgIHJldHVybiBmb3JtYXREdXJhdGlvbihzdGFydFRpbWUsIGVuZFRpbWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0RHVyYXRpb24oc3RhcnQ6IG1vbWVudC5Nb21lbnQsIGVuZDogbW9tZW50Lk1vbWVudCk6IER1cmF0aW9uIHtcclxuICAgIGNvbnN0IGR1cmF0aW9uID0gbW9tZW50LmR1cmF0aW9uKGVuZC5kaWZmKHN0YXJ0KSk7XHJcblxyXG4gICAgY29uc3QgZGF5cyA9IGR1cmF0aW9uLmRheXMoKTtcclxuICAgIGNvbnN0IGhvdXJzID0gZHVyYXRpb24uaG91cnMoKTtcclxuICAgIGNvbnN0IG1pbnV0ZXMgPSBkdXJhdGlvbi5taW51dGVzKCk7XHJcbiAgICBjb25zdCBzZWNvbmRzID0gZHVyYXRpb24uc2Vjb25kcygpO1xyXG5cclxuICAgIGxldCByZWFsRGF5cyA9IGRheXM7XHJcbiAgICBjb25zdCBtb250aHMgPSBkdXJhdGlvbi5tb250aHMoKTtcclxuICAgIGNvbnN0IHllYXJzID0gZHVyYXRpb24ueWVhcnMoKTtcclxuXHJcbiAgICBpZiAoeWVhcnMgPiAwKSB7XHJcbiAgICAgICAgcmVhbERheXMgKz0geWVhcnMgKiAzNjU7XHJcbiAgICB9XHJcbiAgICBpZiAobW9udGhzID4gMCkge1xyXG4gICAgICAgIHJlYWxEYXlzICs9IG1vbnRocyAqIDMwO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgZGF5czogcmVhbERheXMsXHJcbiAgICAgICAgaG91cnMsXHJcbiAgICAgICAgbWludXRlcyxcclxuICAgICAgICBzZWNvbmRzLFxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZUxlbmd0aCh0aW1lOiBEdXJhdGlvbikge1xyXG4gICAgbGV0IHNlY29uZHNMZW5ndGggPSAwO1xyXG4gICAgbGV0IG1pbnV0ZXNMZW5ndGggPSAwO1xyXG4gICAgbGV0IGhvdXJzTGVuZ3RoID0gMDtcclxuICAgIGxldCBkYXlzTGVuZ3RoID0gMDtcclxuXHJcbiAgICBpZiAodGltZS5kYXlzID4gMCkge1xyXG4gICAgICAgIGRheXNMZW5ndGggPSAodGltZS5kYXlzIDwgMTAgPyAxIDogdGltZS5kYXlzLnRvU3RyaW5nKDEwKS5sZW5ndGgpICsgXCIgZGF5c1wiLmxlbmd0aDtcclxuICAgIH1cclxuICAgIGlmICh0aW1lLmhvdXJzID4gMCkge1xyXG4gICAgICAgIGhvdXJzTGVuZ3RoID0gKHRpbWUuaG91cnMgPCAxMCA/IDEgOiAyKSArIFwiIGhycyBcIi5sZW5ndGg7XHJcbiAgICB9XHJcbiAgICBpZiAodGltZS5taW51dGVzID4gMCkge1xyXG4gICAgICAgIG1pbnV0ZXNMZW5ndGggPSAodGltZS5taW51dGVzIDwgMTAgPyAxIDogMikgKyBcIiBtaW5zXCIubGVuZ3RoO1xyXG4gICAgfVxyXG4gICAgaWYgKHRpbWUuZGF5cyA9PT0gMCAmJiB0aW1lLmhvdXJzID09PSAwICYmICgodGltZS5zZWNvbmRzID09PSAwICYmIHRpbWUubWludXRlcyA9PT0gMCkgfHwgdGltZS5zZWNvbmRzID4gMCkpIHtcclxuICAgICAgICBzZWNvbmRzTGVuZ3RoID0gKHRpbWUuc2Vjb25kcyA8IDEwID8gMSA6IDIpICsgXCIgc2Vjc1wiLmxlbmd0aDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGltZS5kYXlzID09PSAwICYmIHRpbWUuaG91cnMgPT09IDAgJiYgdGltZS5taW51dGVzID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aW1lLnNlY29uZHMgPCAxMCA/IDMgOiAyKSArIFwiIHNlY3NcIi5sZW5ndGg7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGRheXNMZW5ndGggKyBob3Vyc0xlbmd0aCArIG1pbnV0ZXNMZW5ndGggKyBzZWNvbmRzTGVuZ3RoICsgMjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrUGFpcnNBbmRMYXN0TWFyayh0aW1lU3RyaW5nOiBzdHJpbmcpOiB7XHJcbiAgICBpc1BhaXJzOiBib29sZWFuO1xyXG4gICAgbGFzdE1hcms6IEluc2VydE1hcmtUeXBlIHwgXCJub25lXCI7XHJcbn0ge1xyXG4gICAgY29uc3Qgc3RhcnRUaW1lTWFya3MgPSB0aW1lU3RyaW5nLm1hdGNoQWxsKG5ldyBSZWdFeHAoc3RhcnRUaW1lc3RhbXBSZWdleCwgXCJnXCIpKTtcclxuICAgIGNvbnN0IGVuZFRpbWVNYXJrcyA9IHRpbWVTdHJpbmcubWF0Y2hBbGwobmV3IFJlZ0V4cChlbmRUaW1lc3RhbXBSZWdleCwgXCJnXCIpKTtcclxuXHJcbiAgICBjb25zdCBzdGFydFRpbWVNYXJrc0FycmF5ID0gQXJyYXkuZnJvbShzdGFydFRpbWVNYXJrcyk7XHJcbiAgICBjb25zdCBlbmRUaW1lTWFya3NBcnJheSA9IEFycmF5LmZyb20oZW5kVGltZU1hcmtzKTtcclxuXHJcbiAgICBjb25zdCBpc1BhaXJzID0gc3RhcnRUaW1lTWFya3NBcnJheS5sZW5ndGggPT09IGVuZFRpbWVNYXJrc0FycmF5Lmxlbmd0aDtcclxuICAgIGNvbnN0IGxhc3RNYXJrID0gaXNQYWlycyA/IChzdGFydFRpbWVNYXJrc0FycmF5Lmxlbmd0aCA+IDAgPyBcImVuZFwiIDogXCJub25lXCIpIDogXCJzdGFydFwiO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBpc1BhaXJzLFxyXG4gICAgICAgIGxhc3RNYXJrLFxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNoZWNrSWZCbGFua0xhc3RDaGFyID0gKHRleHQ6IHN0cmluZyk6IGJvb2xlYW4gPT4gL1xccyQvLnRlc3QodGV4dCk7XHJcbmV4cG9ydCBjb25zdCBjaGVja0lmVGFza0RhdGUgPSAodGV4dDogc3RyaW5nKSA9PiB7XHJcbiAgICByZXR1cm4gdGV4dC5tYXRjaCgvXHUyNzA1IFxcZHs0fS1cXGR7Mn0tXFxkezJ9Lyk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgY2hlY2tCbG9ja0lkID0gKHRleHQ6IHN0cmluZykgPT4ge1xyXG4gICAgcmV0dXJuIHRleHQubWF0Y2goL1xcXlthLXpBLVowLTktXXsyLH0kLyk7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlRnJvbUFuZFRvKGxpbmU6IExpbmUsIGxpbmVUZXh0OiBzdHJpbmcsIHR5cGU6IFwic3RhcnRcIiB8IFwiZW5kXCIsIGFwcDogQXBwKSB7XHJcbiAgICBjb25zdCBkYXRlRm9ybWF0ID0gYXBwLnBsdWdpbnMuZ2V0UGx1Z2luKFwidGltZS1jb3VudGVyXCIpLnNldHRpbmdzLnRpbWVGb3JtYXQudHJpbSgpO1xyXG4gICAgY29uc3QgcGFyc2VkVGltZUZvcm1hdCA9ICFkYXRlRm9ybWF0ICYmIGRhdGVGb3JtYXQ/Lmxlbmd0aCA9PT0gMCA/IFwiWVlZWU1NRERISG1tc3NcIiA6IGRhdGVGb3JtYXQ7XHJcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBtb21lbnQoKS5mb3JtYXQocGFyc2VkVGltZUZvcm1hdCk7XHJcblxyXG4gICAgY29uc3QgZGF0ZUluZGV4ID0gY2hlY2tJZlRhc2tEYXRlKGxpbmVUZXh0KT8uaW5kZXg7XHJcbiAgICBjb25zdCBibG9ja0lkSW5kZXggPSBjaGVja0Jsb2NrSWQobGluZVRleHQpPy5pbmRleDtcclxuXHJcbiAgICBsZXQgaW5zZXJ0VGV4dCA9IFwiXCI7XHJcbiAgICBpZiAoZGF0ZUluZGV4KSB7XHJcbiAgICAgICAgaW5zZXJ0VGV4dCA9IGAke2NoZWNrSWZCbGFua0xhc3RDaGFyKGxpbmVUZXh0LnNsaWNlKDAsIGRhdGVJbmRleCkpID8gYGAgOiBgIGB9WyR7dHlwZX06OiR7dGltZXN0YW1wfV0gYDtcclxuICAgIH0gZWxzZSBpZiAoYmxvY2tJZEluZGV4KSB7XHJcbiAgICAgICAgaW5zZXJ0VGV4dCA9IGAke2NoZWNrSWZCbGFua0xhc3RDaGFyKGxpbmVUZXh0LnNsaWNlKDAsIGJsb2NrSWRJbmRleCkpID8gYGAgOiBgIGB9WyR7dHlwZX06OiR7dGltZXN0YW1wfV0gYDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaW5zZXJ0VGV4dCA9IGAke2NoZWNrSWZCbGFua0xhc3RDaGFyKGxpbmVUZXh0KSA/IGBgIDogYCBgfVske3R5cGV9Ojoke3RpbWVzdGFtcH1dYDtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgdGFyZ2V0RnJvbSA9IGRhdGVJbmRleCA/IGxpbmUuZnJvbSArIGRhdGVJbmRleCA6IGJsb2NrSWRJbmRleCA/IGxpbmUuZnJvbSArIGJsb2NrSWRJbmRleCA6IGxpbmUudG87XHJcbiAgICBsZXQgdGFyZ2V0VG8gPSBkYXRlSW5kZXggPyBsaW5lLmZyb20gKyBkYXRlSW5kZXggOiBibG9ja0lkSW5kZXggPyBsaW5lLmZyb20gKyBibG9ja0lkSW5kZXggOiBsaW5lLnRvO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgdGFyZ2V0RnJvbSxcclxuICAgICAgICB0YXJnZXRUbyxcclxuICAgICAgICBpbnNlcnRUZXh0LFxyXG4gICAgfTtcclxufVxyXG4iLCAiaW1wb3J0IHsgQ2hhbmdlU2V0LCBDaGFuZ2VTcGVjLCBUcmFuc2FjdGlvbiB9IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xyXG5pbXBvcnQgeyBBcHAgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgVmlld1BsdWdpbiwgVmlld1VwZGF0ZSB9IGZyb20gXCJAY29kZW1pcnJvci92aWV3XCI7XHJcbmltcG9ydCB7IGJsYW5rVGFza0l0ZW1SZWdleCwgZW5kVGltZXN0YW1wUmVnZXgsIHN0YXJ0VGltZXN0YW1wUmVnZXgsIHRhc2tJdGVtUmVnZXggfSBmcm9tIFwiLi4vY29uc3RcIjtcclxuaW1wb3J0IHsgY2FsY3VsYXRlRnJvbUFuZFRvLCBjaGVja1BhaXJzQW5kTGFzdE1hcmsgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHNcIjtcclxuXHJcbmNvbnN0IGluc2VydFRpbWVzdGFtcCA9IChcclxuICAgIHVwZGF0ZTogVmlld1VwZGF0ZSxcclxuICAgIGNvbmRpdGlvbjogKGxpbmVUZXh0OiBzdHJpbmcsIGluc2VydGVkOiBzdHJpbmcpID0+IGJvb2xlYW4sXHJcbiAgICB0eXBlOiBJbnNlcnRNYXJrVHlwZSxcclxuICAgIGFwcDogQXBwLFxyXG4pID0+IHtcclxuICAgIGNvbnN0IGNoYW5nZXM6IENoYW5nZVNwZWNbXSA9IFtdO1xyXG4gICAgY29uc3QgdGltZXN0YW1wUmVnZXggPSB0eXBlID09PSBcInN0YXJ0XCIgPyBzdGFydFRpbWVzdGFtcFJlZ2V4IDogZW5kVGltZXN0YW1wUmVnZXg7XHJcblxyXG4gICAgdXBkYXRlLmNoYW5nZXMuaXRlckNoYW5nZXMoKGZyb21BLCB0b0EsIGZyb21CLCB0b0IsIGluc2VydGVkKSA9PiB7XHJcbiAgICAgICAgaWYgKGluc2VydGVkLnRvU3RyaW5nKCkubWF0Y2godGltZXN0YW1wUmVnZXgpIHx8IGluc2VydGVkLnRvU3RyaW5nKCkuc3BsaXQoXCJcXG5cIikubGVuZ3RoID4gMSkgcmV0dXJuO1xyXG4gICAgICAgIGNvbnN0IGZyb21MaW5lID0gdXBkYXRlLnN0YXRlLmRvYy5saW5lQXQoZnJvbUEpO1xyXG4gICAgICAgIGlmICghdXBkYXRlLnN0YXRlLmRvYy5saW5lKGZyb21MaW5lLm51bWJlcikudGV4dC5zdGFydHNXaXRoKFwiLSBcIikpIHJldHVybjtcclxuXHJcbiAgICAgICAgY29uc3QgdG9MaW5lID0gdXBkYXRlLnN0YXRlLmRvYy5saW5lQXQoZnJvbUIpO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gZnJvbUxpbmUubnVtYmVyOyBpIDw9IHRvTGluZS5udW1iZXI7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBsaW5lID0gdXBkYXRlLnN0YXRlLmRvYy5saW5lKGkpO1xyXG4gICAgICAgICAgICBjb25zdCBsaW5lVGV4dCA9IGxpbmUudGV4dDtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBjaGVja1BhaXJzQW5kTGFzdE1hcmsobGluZVRleHQpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNvbmRpdGlvbihsaW5lVGV4dCwgaW5zZXJ0ZWQudG9TdHJpbmcoKSkpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSBcImVuZFwiICYmICEoY3VycmVudC5sYXN0TWFyayA9PT0gXCJzdGFydFwiKSkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09IFwic3RhcnRcIiAmJiBjdXJyZW50Lmxhc3RNYXJrID09PSBcInN0YXJ0XCIpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjaGFuZ2UgPSBjYWxjdWxhdGVGcm9tQW5kVG8obGluZSwgbGluZVRleHQsIHR5cGUsIGFwcCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2hhbmdlcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBmcm9tOiBjaGFuZ2UudGFyZ2V0RnJvbSxcclxuICAgICAgICAgICAgICAgICAgICB0bzogY2hhbmdlLnRhcmdldFRvLFxyXG4gICAgICAgICAgICAgICAgICAgIGluc2VydDogY2hhbmdlLmluc2VydFRleHQsXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBjaGFuZ2VzO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHJlbW92ZVRpbWVzdGFtcHMgPSAobGluZVRleHQ6IHN0cmluZywgdHlwZTogSW5zZXJ0TWFya1R5cGUpID0+IHtcclxuICAgIGxldCB0aW1lc3RhbXBSZWdleCA9IHR5cGUgPT09IFwic3RhcnRcIiA/IHN0YXJ0VGltZXN0YW1wUmVnZXggOiBlbmRUaW1lc3RhbXBSZWdleDtcclxuXHJcbiAgICBpZiAoIXRpbWVzdGFtcFJlZ2V4Lmdsb2JhbCkge1xyXG4gICAgICAgIGNvbnN0IGZsYWdzID0gdGltZXN0YW1wUmVnZXguZmxhZ3MgKyBcImdcIjtcclxuICAgICAgICB0aW1lc3RhbXBSZWdleCA9IG5ldyBSZWdFeHAodGltZXN0YW1wUmVnZXguc291cmNlLCBmbGFncyk7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IG1hdGNoOiBSZWdFeHBFeGVjQXJyYXkgfCBudWxsO1xyXG4gICAgbGV0IGxhc3RNYXRjaDogUmVnRXhwRXhlY0FycmF5IHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgd2hpbGUgKChtYXRjaCA9IHRpbWVzdGFtcFJlZ2V4LmV4ZWMobGluZVRleHQpKSAhPT0gbnVsbCkge1xyXG4gICAgICAgIGxhc3RNYXRjaCA9IG1hdGNoO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChsYXN0TWF0Y2gpIHtcclxuICAgICAgICBjb25zdCB0aW1lc3RhbXBQb3MgPSBsaW5lVGV4dC5pbmRleE9mKGxhc3RNYXRjaFswXSk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZnJvbTogdGltZXN0YW1wUG9zLFxyXG4gICAgICAgICAgICB0bzogdGltZXN0YW1wUG9zICsgbGFzdE1hdGNoWzBdLmxlbmd0aCxcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZFRhc2tUaW1lTWFya1BsdWdpbiA9IChhcHA6IEFwcCkgPT4ge1xyXG4gICAgcmV0dXJuIFZpZXdQbHVnaW4uZnJvbUNsYXNzKFxyXG4gICAgICAgIGNsYXNzIHtcclxuICAgICAgICAgICAgdXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF1cGRhdGUuZG9jQ2hhbmdlZCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZS50cmFuc2FjdGlvbnMuc29tZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgKHRyKSA9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIuYW5ub3RhdGlvbihUcmFuc2FjdGlvbi51c2VyRXZlbnQpID09PSBcInVuZG9cIiB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIuYW5ub3RhdGlvbihUcmFuc2FjdGlvbi51c2VyRXZlbnQpID09PSBcInJlZG9cIiB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHIuYW5ub3RhdGlvbihUcmFuc2FjdGlvbi51c2VyRXZlbnQpID09PSBcInBsdWdpbi11cGRhdGVcIixcclxuICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0Q2hhbmdlcyA9IGluc2VydFRpbWVzdGFtcChcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgKGxpbmVUZXh0LCBpbnNlcnRlZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFJlZ0V4cCh0YXNrSXRlbVJlZ2V4KS50ZXN0KGxpbmVUZXh0KSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKC8tIFxcW1xcc1xcXS9nLnRlc3QoaW5zZXJ0ZWQpIHx8IC8tXFxzXFxbXFxzXFxdJC9nLnRlc3QobGluZVRleHQpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgXCJzdGFydFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGFwcCxcclxuICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgZW5kQ2hhbmdlcyA9IGluc2VydFRpbWVzdGFtcChcclxuICAgICAgICAgICAgICAgICAgICB1cGRhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgKGxpbmVUZXh0LCBpbnNlcnRlZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFJlZ0V4cCh0YXNrSXRlbVJlZ2V4KS50ZXN0KGxpbmVUZXh0KSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKC8tIFxcW1teXFxzXVxcXS9nLnRlc3QoaW5zZXJ0ZWQpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKC8tXFxzXFxbW15cXHNdXFxdL2cudGVzdChsaW5lVGV4dCkgJiYgLyh4fFgpL2cudGVzdChpbnNlcnRlZCkpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgXCJlbmRcIixcclxuICAgICAgICAgICAgICAgICAgICBhcHAsXHJcbiAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNoYW5nZXMgPSBbLi4uc3RhcnRDaGFuZ2VzLCAuLi5lbmRDaGFuZ2VzXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodXBkYXRlLnRyYW5zYWN0aW9ucy5zb21lKCh0cikgPT4gdHIuYW5ub3RhdGlvbihUcmFuc2FjdGlvbi51c2VyRXZlbnQpID09PSBcInBsdWdpbi11cGRhdGVcIikpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoY2hhbmdlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRyID0gdXBkYXRlLnZpZXcuc3RhdGUudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZXM6IENoYW5nZVNldC5vZihjaGFuZ2VzLCB1cGRhdGUudmlldy5zdGF0ZS5kb2MubGVuZ3RoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZS52aWV3LmRpc3BhdGNoKHRyKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICApO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHJlbW92ZVRhc2tUaW1lTWFya1BsdWdpbiA9IFZpZXdQbHVnaW4uZnJvbUNsYXNzKFxyXG4gICAgY2xhc3Mge1xyXG4gICAgICAgIHVwZGF0ZSh1cGRhdGU6IFZpZXdVcGRhdGUpIHtcclxuICAgICAgICAgICAgaWYgKCF1cGRhdGUuZG9jQ2hhbmdlZCkgcmV0dXJuO1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICB1cGRhdGUudHJhbnNhY3Rpb25zLnNvbWUoXHJcbiAgICAgICAgICAgICAgICAgICAgKHRyKSA9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ci5hbm5vdGF0aW9uKFRyYW5zYWN0aW9uLnVzZXJFdmVudCkgPT09IFwidW5kb1wiIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyLmFubm90YXRpb24oVHJhbnNhY3Rpb24udXNlckV2ZW50KSA9PT0gXCJyZWRvXCIgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHIuYW5ub3RhdGlvbihUcmFuc2FjdGlvbi51c2VyRXZlbnQpID09PSBcInBsdWdpbi11cGRhdGVcIixcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgbGV0IGNoYW5nZXM6IENoYW5nZVNwZWNbXSA9IFtdO1xyXG5cclxuICAgICAgICAgICAgdXBkYXRlLmNoYW5nZXMuaXRlckNoYW5nZXMoKGZyb21BLCB0b0EsIGZyb21CLCB0b0IsIGluc2VydGVkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmcm9tTGluZSA9IHVwZGF0ZS5zdGF0ZS5kb2MubGluZUF0KGZyb21BKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRvTGluZSA9IHVwZGF0ZS5zdGF0ZS5kb2MubGluZUF0KGZyb21CKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgIWluc2VydGVkLnRvU3RyaW5nKCkuaW5jbHVkZXMoXCItIFwiKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICFpbnNlcnRlZC50b1N0cmluZygpLmluY2x1ZGVzKFwiLSBbIF1cIikgJiZcclxuICAgICAgICAgICAgICAgICAgICAhL1xccy8udGVzdChpbnNlcnRlZC50b1N0cmluZygpKVxyXG4gICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFmcm9tTGluZS50ZXh0LnRyaW0oKS5zdGFydHNXaXRoKFwiLSBcIikgJiYgIWZyb21MaW5lLnRleHQudHJpbSgpLnN0YXJ0c1dpdGgoXCItIFsgXVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gY2hlY2tQYWlyc0FuZExhc3RNYXJrKGZyb21MaW5lLnRleHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQubGFzdE1hcmsgPT09IFwic3RhcnRcIiAmJiAhL14tJC9nLnRlc3QoaW5zZXJ0ZWQudG9TdHJpbmcoKS50cmltKCkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGluc2VydEJsYW5rVGFzayA9IGluc2VydGVkLnRvU3RyaW5nKCkuaW5jbHVkZXMoXCItIFsgXVwiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGluc2VydEJ1bGxldE1hcmsgPSAvXi0kLy50ZXN0KGluc2VydGVkLnRvU3RyaW5nKCkudHJpbSgpKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGluc2VydEJsYW5rV29yZCA9IC9cXHMvLnRlc3QoaW5zZXJ0ZWQudG9TdHJpbmcoKSkgJiYgZnJvbUxpbmUudGV4dC50cmltKCkuc3RhcnRzV2l0aChcIi0gWyBdXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAoY3VycmVudC5sYXN0TWFyayA9PT0gXCJlbmRcIiAmJiAhKGluc2VydEJ1bGxldE1hcmsgfHwgaW5zZXJ0QmxhbmtXb3JkKSkgfHxcclxuICAgICAgICAgICAgICAgICAgICAoY3VycmVudC5sYXN0TWFyayA9PT0gXCJlbmRcIiAmJiBpbnNlcnRCbGFua1Rhc2spXHJcbiAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IGZyb21MaW5lLm51bWJlcjsgaSA8PSB0b0xpbmUubnVtYmVyOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lID0gdXBkYXRlLnN0YXRlLmRvYy5saW5lKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVUZXh0ID0gbGluZS50ZXh0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaFRhc2tJdGVtID0gbmV3IFJlZ0V4cCh0YXNrSXRlbVJlZ2V4KS50ZXN0KGxpbmVUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250YWluc1N0YXJ0VGltZXN0YW1wID0gbmV3IFJlZ0V4cChzdGFydFRpbWVzdGFtcFJlZ2V4KS50ZXN0KGxpbmVUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250YWluc0VuZFRpbWVzdGFtcCA9IG5ldyBSZWdFeHAoZW5kVGltZXN0YW1wUmVnZXgpLnRlc3QobGluZVRleHQpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGVyZSdzIG5vIHRhc2sgaXRlbSBhbmQgYm90aCB0aW1lc3RhbXBzIGFyZSBwcmVzZW50XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtYXRjaFRhc2tJdGVtICYmIGNvbnRhaW5zU3RhcnRUaW1lc3RhbXAgJiYgY29udGFpbnNFbmRUaW1lc3RhbXApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSByZW1vdmVUaW1lc3RhbXBzKGxpbmVUZXh0LCBcInN0YXJ0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmQgPSByZW1vdmVUaW1lc3RhbXBzKGxpbmVUZXh0LCBcImVuZFwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGFydCAmJiAhZW5kKSBjaGFuZ2VzLnB1c2goeyBmcm9tOiBsaW5lLmZyb20gKyBzdGFydC5mcm9tLCB0bzogbGluZS5mcm9tICsgc3RhcnQudG8gfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbmQgJiYgIXN0YXJ0KSBjaGFuZ2VzLnB1c2goeyBmcm9tOiBsaW5lLmZyb20gKyBlbmQuZnJvbSwgdG86IGxpbmUuZnJvbSArIGVuZC50byB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0ICYmIGVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlcy5wdXNoKHsgZnJvbTogbGluZS5mcm9tICsgc3RhcnQuZnJvbSwgdG86IGxpbmUuZnJvbSArIHN0YXJ0LnRvIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlcy5wdXNoKHsgZnJvbTogbGluZS5mcm9tICsgZW5kLmZyb20sIHRvOiBsaW5lLmZyb20gKyBlbmQudG8gfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlJ3MgYSB0YXNrIGl0ZW0gYW5kIG9ubHkgZW5kIHRpbWVzdGFtcCBpcyBwcmVzZW50XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoVGFza0l0ZW0gJiYgbmV3IFJlZ0V4cChibGFua1Rhc2tJdGVtUmVnZXgpLnRlc3QobGluZVRleHQpICYmIGNvbnRhaW5zRW5kVGltZXN0YW1wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZCA9IHJlbW92ZVRpbWVzdGFtcHMobGluZVRleHQsIFwiZW5kXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5kKSBjaGFuZ2VzLnB1c2goeyBmcm9tOiBsaW5lLmZyb20gKyBlbmQuZnJvbSwgdG86IGxpbmUuZnJvbSArIGVuZC50byB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKHVwZGF0ZS50cmFuc2FjdGlvbnMuc29tZSgodHIpID0+IHRyLmFubm90YXRpb24oVHJhbnNhY3Rpb24udXNlckV2ZW50KSA9PT0gXCJwbHVnaW4tdXBkYXRlXCIpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBpZiAoY2hhbmdlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ciA9IHVwZGF0ZS52aWV3LnN0YXRlLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZXM6IENoYW5nZVNldC5vZihjaGFuZ2VzLCB1cGRhdGUudmlldy5zdGF0ZS5kb2MubGVuZ3RoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYW5ub3RhdGlvbnM6IFRyYW5zYWN0aW9uLnVzZXJFdmVudC5vZihcInBsdWdpbi11cGRhdGVcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlLnZpZXcuZGlzcGF0Y2godHIpO1xyXG4gICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4pO1xyXG4iLCAiaW1wb3J0IHsgQXBwLCBFZGl0b3IsIG1vbWVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgc3RhcnRUaW1lc3RhbXBSZWdleCB9IGZyb20gXCIuLi9jb25zdFwiO1xuXG5leHBvcnQgY29uc3QgaW5zZXJ0TWFyayA9IChhcHA6IEFwcCwgZWRpdG9yOiBFZGl0b3IsIHR5cGU6IEluc2VydE1hcmtUeXBlKSA9PiB7XG4gICAgY29uc3QgZm9ybWF0ID0gYXBwLnBsdWdpbnMuZ2V0UGx1Z2luKFwidGltZS1jb3VudGVyXCIpLnNldHRpbmdzLnRpbWVGb3JtYXQudHJpbSgpO1xuICAgIGNvbnN0IHRpbWUgPSBtb21lbnQoKS5mb3JtYXQoZm9ybWF0KTtcbiAgICBjb25zdCBzZWxlY3Rpb24gPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG4gICAgaWYgKHNlbGVjdGlvbi50cmltKCkubGVuZ3RoID4gMCkgcmV0dXJuO1xuXG4gICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oYFske3R5cGV9Ojoke3RpbWV9XWApO1xufTtcblxuZXhwb3J0IGNvbnN0IGNoZWNrRXhpc3RTdGFydE1hcmsgPSAoZWRpdG9yOiBFZGl0b3IpID0+IHtcbiAgICBjb25zdCBnZXRQb3MgPSBlZGl0b3IuZ2V0Q3Vyc29yKFwiZnJvbVwiKTtcbiAgICBjb25zdCBnZXRMaW5lID0gZWRpdG9yLmdldExpbmUoZ2V0UG9zLmxpbmUpO1xuXG4gICAgY29uc3QgbWF0Y2ggPSBnZXRMaW5lLm1hdGNoKHN0YXJ0VGltZXN0YW1wUmVnZXgpO1xuXG4gICAgaWYgKG1hdGNoKSByZXR1cm4gdHJ1ZTtcbiAgICByZXR1cm4gZmFsc2U7XG59O1xuIiwgImltcG9ydCB7IERlY29yYXRpb24sIERlY29yYXRpb25TZXQsIEVkaXRvclZpZXcsIFdpZGdldFR5cGUgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuaW1wb3J0IHsgRWRpdG9yU3RhdGUsIFJhbmdlU2V0QnVpbGRlciwgU3RhdGVGaWVsZCB9IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xuaW1wb3J0IHsgaW5pdExvZ2Jvb2tUaW1lQ291bnRlck1hcmsgfSBmcm9tIFwiLi4vdXRpbHMvZG9tVXRpbHNcIjtcblxuZXhwb3J0IGNvbnN0IGxvZ2Jvb2tGaWVsZCA9IFN0YXRlRmllbGQuZGVmaW5lPFxuICAgIHtcbiAgICAgICAgZnJvbTogbnVtYmVyO1xuICAgICAgICB0bzogbnVtYmVyO1xuICAgIH1bXVxuPih7XG4gICAgY3JlYXRlOiAoc3RhdGUpID0+IHtcbiAgICAgICAgbGV0IHJhbmdlczoge1xuICAgICAgICAgICAgZnJvbTogYW55O1xuICAgICAgICAgICAgdG86IG51bWJlcjtcbiAgICAgICAgfVtdID0gW107XG4gICAgICAgIGxldCBsaW5lczogbnVtYmVyW10gPSBbXTtcblxuICAgICAgICBpZiAoc3RhdGUuZG9jLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGxpbmVzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogc3RhdGUuZG9jLmxpbmVzIH0sIChfLCBpKSA9PiBpICsgMSk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBuIG9mIGxpbmVzKSB7XG4gICAgICAgICAgICBsZXQgbGluZSA9IHN0YXRlLmRvYy5saW5lKG4pO1xuICAgICAgICAgICAgbGV0IGZyb21JZHggPSBsaW5lLnRleHQuaW5kZXhPZihcIjpsb2dib29rOlwiKTtcbiAgICAgICAgICAgIGlmIChmcm9tSWR4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIGxldCBlbmRJZHggPSAtMTtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gbjsgaSA8IHN0YXRlLmRvYy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUuZG9jLmxpbmUoaSk/LnRleHQuaW5kZXhPZihcIjpFTkQ6XCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5kSWR4ID0gc3RhdGUuZG9jLmxpbmUoaSkudG87XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZW5kSWR4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBsZXQgZnJvbSA9IHN0YXRlLmRvYy5saW5lKG4pLmZyb20gKyBmcm9tSWR4O1xuICAgICAgICAgICAgICAgICAgICBsZXQgZnJvbSA9IHN0YXRlLmRvYy5saW5lKG4pLmZyb20gLSAxO1xuICAgICAgICAgICAgICAgICAgICByYW5nZXMucHVzaCh7IGZyb20sIHRvOiBlbmRJZHggfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByYW5nZXM7XG4gICAgfSxcbiAgICB1cGRhdGUodmFsdWUsIHRyKSB7XG4gICAgICAgIGlmICghdHIuZG9jQ2hhbmdlZCkgcmV0dXJuIHZhbHVlO1xuICAgICAgICBsZXQgcmFuZ2VzOiB7XG4gICAgICAgICAgICBmcm9tOiBhbnk7XG4gICAgICAgICAgICB0bzogbnVtYmVyO1xuICAgICAgICB9W10gPSBbXTtcbiAgICAgICAgbGV0IGxpbmVzOiBudW1iZXJbXSA9IFtdO1xuXG4gICAgICAgIGlmICh0ci5zdGF0ZS5kb2MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbGluZXMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiB0ci5zdGF0ZS5kb2MubGluZXMgfSwgKF8sIGkpID0+IGkgKyAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IG4gb2YgbGluZXMpIHtcbiAgICAgICAgICAgIGxldCBsaW5lID0gdHIuc3RhdGUuZG9jLmxpbmUobik7XG4gICAgICAgICAgICBsZXQgZnJvbUlkeCA9IGxpbmUudGV4dC5pbmRleE9mKFwiOmxvZ2Jvb2s6XCIpO1xuICAgICAgICAgICAgaWYgKGZyb21JZHggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgbGV0IGVuZElkeCA9IC0xO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBuOyBpIDwgdHIubmV3RG9jLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRFZGl0aW5nID0gdHIubmV3U2VsZWN0aW9uLnJhbmdlc1swXS5mcm9tO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lTnVtID0gdHIubmV3RG9jLmxpbmVBdChjdXJyZW50RWRpdGluZykubnVtYmVyO1xuICAgICAgICAgICAgICAgICAgICBpZiAobGluZU51bSA9PT0gaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAodHIubmV3RG9jLmxpbmUoaSk/LnRleHQuaW5kZXhPZihcIjpFTkQ6XCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5kSWR4ID0gdHIubmV3RG9jLmxpbmUoaSkudG87XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChlbmRJZHggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBmcm9tID0gdHIuc3RhdGUuZG9jLmxpbmUobikuZnJvbSAtIDE7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlcy5wdXNoKHsgZnJvbSwgdG86IGVuZElkeCB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJhbmdlcztcbiAgICB9LFxufSk7XG5cbi8vIFx1NUI5QVx1NEU0OVx1NEUwMFx1NEUyQVx1ODg0Q1x1NTE4NSB3aWRnZXRcbmNsYXNzIElubGluZUxvZ2Jvb2sgZXh0ZW5kcyBXaWRnZXRUeXBlIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcmVhZG9ubHkgdmlldzogRWRpdG9yU3RhdGUsXG4gICAgICAgIHJlYWRvbmx5IGZyb206IG51bWJlcixcbiAgICAgICAgcmVhZG9ubHkgdG86IG51bWJlcixcbiAgICAgICAgcmVhZG9ubHkgY29udGVudDogc3RyaW5nLFxuICAgICkge1xuICAgICAgICBzdXBlcigpO1xuICAgIH1cblxuICAgIGVxKG90aGVyOiBJbmxpbmVMb2dib29rKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBvdGhlci52aWV3ID09PSB0aGlzLnZpZXcgJiZcbiAgICAgICAgICAgIG90aGVyLmZyb20gPT09IHRoaXMuZnJvbSAmJlxuICAgICAgICAgICAgb3RoZXIudG8gPT09IHRoaXMudG8gJiZcbiAgICAgICAgICAgIG90aGVyLmNvbnRlbnQgPT09IHRoaXMuY29udGVudFxuICAgICAgICApO1xuICAgIH1cblxuICAgIHRvRE9NKCkge1xuICAgICAgICByZXR1cm4gaW5pdExvZ2Jvb2tUaW1lQ291bnRlck1hcmsodGhpcy5jb250ZW50KTtcbiAgICB9XG5cbiAgICBpZ25vcmVFdmVudChldmVudDogRXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IGxvZ2Jvb2tEZWNvcmF0aW9ucyA9IFN0YXRlRmllbGQuZGVmaW5lPERlY29yYXRpb25TZXQ+KHtcbiAgICBjcmVhdGU6IChzdGF0ZSkgPT4ge1xuICAgICAgICBsZXQgYnVpbGRlciA9IG5ldyBSYW5nZVNldEJ1aWxkZXI8RGVjb3JhdGlvbj4oKTtcbiAgICAgICAgbGV0IGRvYyA9IHN0YXRlLmRvYztcbiAgICAgICAgbGV0IGxvZ2Jvb2tSYW5nZXMgPSBzdGF0ZS5maWVsZChsb2dib29rRmllbGQsIGZhbHNlKSB8fCBbXTtcblxuICAgICAgICBmb3IgKGxldCByYW5nZSBvZiBsb2dib29rUmFuZ2VzKSB7XG4gICAgICAgICAgICBsZXQgY29udGVudCA9IGRvYy5zbGljZVN0cmluZyhyYW5nZS5mcm9tLCByYW5nZS50byk7XG5cbiAgICAgICAgICAgIGxldCB3aWRnZXQgPSBEZWNvcmF0aW9uLndpZGdldCh7XG4gICAgICAgICAgICAgICAgd2lkZ2V0OiBuZXcgSW5saW5lTG9nYm9vayhzdGF0ZSwgcmFuZ2UuZnJvbSwgcmFuZ2UudG8sIGNvbnRlbnQpLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGJ1aWxkZXIuYWRkKHJhbmdlLmZyb20sIHJhbmdlLmZyb20sIHdpZGdldCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJ1aWxkZXIuZmluaXNoKCk7XG4gICAgfSxcblxuICAgIHVwZGF0ZShkZWNvcmF0aW9ucywgdHIpIHtcbiAgICAgICAgaWYgKCF0ci5kb2NDaGFuZ2VkKSByZXR1cm4gZGVjb3JhdGlvbnM7IC8vIFx1NTk4Mlx1Njc5Q1x1NjU4N1x1Njg2M1x1NkNBMVx1NjcwOVx1NTNEOFx1NTMxNlx1RkYwQ1x1NzZGNFx1NjNBNVx1OEZENFx1NTZERVx1NzNCMFx1NjcwOVx1NzY4NFx1ODhDNVx1OTk3MFx1OTZDNlxuXG4gICAgICAgIGxldCBidWlsZGVyID0gbmV3IFJhbmdlU2V0QnVpbGRlcjxEZWNvcmF0aW9uPigpO1xuICAgICAgICBsZXQgZG9jID0gdHIuc3RhdGUuZG9jO1xuICAgICAgICBsZXQgbG9nYm9va1JhbmdlcyA9IHRyLnN0YXRlLmZpZWxkKGxvZ2Jvb2tGaWVsZCwgZmFsc2UpIHx8IFtdO1xuXG4gICAgICAgIGZvciAobGV0IHJhbmdlIG9mIGxvZ2Jvb2tSYW5nZXMpIHtcbiAgICAgICAgICAgIGxldCBjb250ZW50ID0gZG9jLnNsaWNlU3RyaW5nKHJhbmdlLmZyb20sIHJhbmdlLnRvKTtcblxuICAgICAgICAgICAgbGV0IHdpZGdldCA9IERlY29yYXRpb24ud2lkZ2V0KHtcbiAgICAgICAgICAgICAgICB3aWRnZXQ6IG5ldyBJbmxpbmVMb2dib29rKHRyLnN0YXRlLCByYW5nZS5mcm9tLCByYW5nZS50bywgY29udGVudCksXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYnVpbGRlci5hZGQocmFuZ2UuZnJvbSwgcmFuZ2UuZnJvbSwgd2lkZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYnVpbGRlci5maW5pc2goKTtcbiAgICB9LFxuXG4gICAgcHJvdmlkZTogKGYpID0+IEVkaXRvclZpZXcuZGVjb3JhdGlvbnMuZnJvbShmKSxcbn0pO1xuIiwgImltcG9ydCB7IERlY29yYXRpb24sIERlY29yYXRpb25TZXQsIEVkaXRvclZpZXcsIFZpZXdQbHVnaW4sIFZpZXdVcGRhdGUsIFdpZGdldFR5cGUgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuaW1wb3J0IHsgQXBwLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBjYWxjdWxhdGVGcm9tQW5kVG8sIGNoZWNrUGFpcnNBbmRMYXN0TWFyayB9IGZyb20gXCIuLi91dGlscy91dGlsc1wiO1xuaW1wb3J0IHsgTGluZSwgUmFuZ2VTZXRCdWlsZGVyLCBUcmFuc2FjdGlvbiB9IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xuXG5jbGFzcyBQbGF5V2lkZ2V0IGV4dGVuZHMgV2lkZ2V0VHlwZSB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHJlYWRvbmx5IGFwcDogQXBwLFxuICAgICAgICByZWFkb25seSB2aWV3OiBFZGl0b3JWaWV3LFxuICAgICAgICByZWFkb25seSBmcm9tOiBudW1iZXIsXG4gICAgICAgIHJlYWRvbmx5IHR5cGU6IEluc2VydE1hcmtUeXBlLFxuICAgICAgICByZWFkb25seSBsaW5lOiBMaW5lLFxuICAgICkge1xuICAgICAgICBzdXBlcigpO1xuICAgIH1cblxuICAgIGVxKG90aGVyOiBQbGF5V2lkZ2V0KSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBvdGhlci52aWV3ID09PSB0aGlzLnZpZXcgJiYgb3RoZXIuZnJvbSA9PT0gdGhpcy5mcm9tICYmIG90aGVyLnR5cGUgPT09IHRoaXMudHlwZSAmJiBvdGhlci5saW5lID09PSB0aGlzLmxpbmVcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICB0b0RPTSgpIHtcbiAgICAgICAgbGV0IGljb24gPSBjcmVhdGVTcGFuKFwiY20tdGltZS1jb3VudGVyLXBsYXktYnV0dG9uXCIpO1xuICAgICAgICBpZiAodGhpcy50eXBlID09PSBcInN0YXJ0XCIpIHtcbiAgICAgICAgICAgIHNldEljb24oaWNvbiwgXCJ0aW1lclwiKTtcbiAgICAgICAgICAgIGljb24udG9nZ2xlQ2xhc3MoXCJjbS1wbGF5LWJ1dHRvbi1lbmRcIiwgZmFsc2UpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudHlwZSA9PT0gXCJlbmRcIikge1xuICAgICAgICAgICAgc2V0SWNvbihpY29uLCBcInRpbWVyLW9mZlwiKTtcbiAgICAgICAgICAgIGljb24udG9nZ2xlQ2xhc3MoXCJjbS1wbGF5LWJ1dHRvbi1lbmRcIiwgdHJ1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjaGFuZ2UgPSBjYWxjdWxhdGVGcm9tQW5kVG8odGhpcy5saW5lLCB0aGlzLmxpbmUudGV4dCwgdGhpcy50eXBlLCB0aGlzLmFwcCk7XG5cbiAgICAgICAgICAgIGNvbnN0IHRyID0gdGhpcy52aWV3LnN0YXRlLnVwZGF0ZSh7XG4gICAgICAgICAgICAgICAgY2hhbmdlczogeyBmcm9tOiBjaGFuZ2UudGFyZ2V0RnJvbSwgdG86IGNoYW5nZS50YXJnZXRUbywgaW5zZXJ0OiBjaGFuZ2UuaW5zZXJ0VGV4dCB9LFxuICAgICAgICAgICAgICAgIHNjcm9sbEludG9WaWV3OiB0cnVlLFxuICAgICAgICAgICAgICAgIGFubm90YXRpb25zOiBUcmFuc2FjdGlvbi51c2VyRXZlbnQub2YoXCJwbHVnaW4tdXBkYXRlXCIpLFxuICAgICAgICAgICAgICAgIHNlbGVjdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBhbmNob3I6IGNoYW5nZS50YXJnZXRUbyArIGNoYW5nZS5pbnNlcnRUZXh0Lmxlbmd0aCB8fCAwLFxuICAgICAgICAgICAgICAgICAgICBoZWFkOiBjaGFuZ2UudGFyZ2V0VG8gKyBjaGFuZ2UuaW5zZXJ0VGV4dC5sZW5ndGggfHwgMCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMudmlldy5kaXNwYXRjaCh0cik7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gaWNvbjtcbiAgICB9XG5cbiAgICBpZ25vcmVFdmVudChldmVudDogRXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkUGxheURlY29zKGFwcDogQXBwLCB2aWV3OiBFZGl0b3JWaWV3KSB7XG4gICAgY29uc3QgYnVpbGRlciA9IG5ldyBSYW5nZVNldEJ1aWxkZXI8RGVjb3JhdGlvbj4oKTtcbiAgICBjb25zdCBzZWVuOiBTZXQ8bnVtYmVyPiA9IG5ldyBTZXQoKTtcblxuICAgIGZvciAoY29uc3QgeyBmcm9tLCB0byB9IG9mIHZpZXcudmlzaWJsZVJhbmdlcykge1xuICAgICAgICBmb3IgKGxldCBwb3MgPSBmcm9tOyBwb3MgPD0gdG87ICkge1xuICAgICAgICAgICAgY29uc3QgbGluZSA9IHZpZXcuc3RhdGUuZG9jLmxpbmVBdChwb3MpO1xuICAgICAgICAgICAgaWYgKCFzZWVuLmhhcyhsaW5lLmZyb20pKSB7XG4gICAgICAgICAgICAgICAgc2Vlbi5hZGQobGluZS5mcm9tKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGluc2VydE1hcmtzID0gY2hlY2tQYWlyc0FuZExhc3RNYXJrKGxpbmUudGV4dCk7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFR5cGUgPSBpbnNlcnRNYXJrcy5sYXN0TWFyayA9PT0gXCJzdGFydFwiID8gXCJlbmRcIiA6IFwic3RhcnRcIjtcblxuICAgICAgICAgICAgICAgIGJ1aWxkZXIuYWRkKFxuICAgICAgICAgICAgICAgICAgICBsaW5lLmZyb20sIC8vIHBvc2l0aW9uIGF0IHRoZSBzdGFydCBvZiB0aGUgbGluZVxuICAgICAgICAgICAgICAgICAgICBsaW5lLmZyb20sXG4gICAgICAgICAgICAgICAgICAgIERlY29yYXRpb24ud2lkZ2V0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldDogbmV3IFBsYXlXaWRnZXQoYXBwLCB2aWV3LCBwb3MsIGN1cnJlbnRUeXBlLCBsaW5lKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZGU6IC0xLCAvLyBzZXQgc2lkZSB0byAtMSB0byBkaXNwbGF5IGF0IHRoZSBzdGFydCBvZiB0aGUgbGluZVxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwb3MgPSBsaW5lLnRvICsgMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBidWlsZGVyLmZpbmlzaCgpO1xufVxuXG5leHBvcnQgY29uc3QgcGxheVdpZGdldFBsdWdpbiA9IChhcHA6IEFwcCkgPT4ge1xuICAgIHJldHVybiBWaWV3UGx1Z2luLmZyb21DbGFzcyhcbiAgICAgICAgY2xhc3Mge1xuICAgICAgICAgICAgZGVjb3JhdGlvbnM6IERlY29yYXRpb25TZXQ7XG5cbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHZpZXc6IEVkaXRvclZpZXcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRlY29yYXRpb25zID0gYnVpbGRQbGF5RGVjb3MoYXBwLCB2aWV3KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSkge1xuICAgICAgICAgICAgICAgIGlmICh1cGRhdGUuZG9jQ2hhbmdlZCB8fCB1cGRhdGUudmlld3BvcnRDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSBidWlsZFBsYXlEZWNvcyhhcHAsIHVwZGF0ZS52aWV3KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGRlY29yYXRpb25zOiAodikgPT4gdi5kZWNvcmF0aW9ucyxcbiAgICAgICAgfSxcbiAgICApO1xufTtcbiIsICJpbXBvcnQgKiBhcyBjcnlwdG8gZnJvbSBcImNyeXB0b1wiO1xuaW1wb3J0IFRpbWVDb3VudGVyUGx1Z2luIGZyb20gXCIuLi90aW1lQ291bnRlckluZGV4XCI7XG5pbXBvcnQgeyBub3JtYWxpemVQYXRoLCByZXF1ZXN0VXJsLCBSZXF1ZXN0VXJsUGFyYW0sIFJlcXVlc3RVcmxSZXNwb25zZVByb21pc2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuY29uc3QgU0VSVkVSX1VSTCA9IFwiYXBpLmJvbmluYWxsLmNvbVwiO1xuY29uc3QgQVBJX1BBVEggPSBcIi9vYi92YWxpZGF0ZVwiO1xuXG5leHBvcnQgY2xhc3MgUmVnaXN0cmF0aW9uIHtcbiAgICBwcml2YXRlIGRiUGF0aDogc3RyaW5nO1xuICAgIHByaXZhdGUgcGx1Z2luOiBUaW1lQ291bnRlclBsdWdpbjtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogVGltZUNvdW50ZXJQbHVnaW4pIHtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuZGJQYXRoID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmNvbmZpZ0RpciArIFwiL3JlZ2lzdGVyLmRiXCI7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGluaXQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGZpbGVFeGlzdHMgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQuYWRhcHRlci5leGlzdHMobm9ybWFsaXplUGF0aCh0aGlzLmRiUGF0aCkpO1xuICAgICAgICBpZiAoIWZpbGVFeGlzdHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHJhbmRvbSA9IGNyeXB0by5yYW5kb21CeXRlcygyNSkudG9TdHJpbmcoXCJoZXhcIik7XG4gICAgICAgICAgICBjb25zdCBkb3VibGVNRDUgPSB0aGlzLm1kNSh0aGlzLm1kNShyYW5kb20pKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5jcmVhdGUodGhpcy5kYlBhdGgsIGRvdWJsZU1ENSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2V0TWFjaGluZUNvZGUoKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgZmlsZUV4aXN0cyA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyLmV4aXN0cyhub3JtYWxpemVQYXRoKHRoaXMuZGJQYXRoKSk7XG5cbiAgICAgICAgaWYgKCFmaWxlRXhpc3RzKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQuYWRhcHRlci5yZWFkKG5vcm1hbGl6ZVBhdGgodGhpcy5kYlBhdGgpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubWQ1KHRoaXMubWQ1KGNvbnRlbnQpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGdldFJlZ0NvZGUoKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgcmVnQ29kZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnJlZ0NvZGU7XG4gICAgICAgIGlmIChyZWdDb2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVnQ29kZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGNoZWNrU3RhdHVzKG1hY2hpbmVJZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgdXJsID0gYGh0dHBzOi8vJHtTRVJWRVJfVVJMfSR7QVBJX1BBVEh9YDtcbiAgICAgICAgY29uc3QgbWV0aG9kID0gXCJQT1NUXCI7XG4gICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gXCJhcHBsaWNhdGlvbi9qc29uXCI7XG4gICAgICAgIGNvbnN0IHJlZ0NvZGUgPSBhd2FpdCB0aGlzLmdldFJlZ0NvZGUoKTtcbiAgICAgICAgaWYgKCFyZWdDb2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBib2R5ID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgbWFjaGluZUlkLFxuICAgICAgICAgICAgcmVzS2V5OiBcIm9ic2lkaWFuLVwiICsgdGhpcy5wbHVnaW4ubWFuaWZlc3QuaWQsXG4gICAgICAgICAgICByZWdDb2RlLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IGNvbnRlbnRUeXBlLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHJlcXVlc3Q6IFJlcXVlc3RVcmxQYXJhbSA9IHtcbiAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgIG1ldGhvZCxcbiAgICAgICAgICAgIGNvbnRlbnRUeXBlLFxuICAgICAgICAgICAgYm9keSxcbiAgICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgIH07XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlOiBSZXF1ZXN0VXJsUmVzcG9uc2VQcm9taXNlID0gcmVxdWVzdFVybChyZXF1ZXN0KTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlQm9keSA9IGF3YWl0IHJlc3BvbnNlLnRleHQ7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2VCb2R5O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIlJlcXVlc3QgZmFpbGVkOlwiLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgbWQ1KGRhdGE6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBjcnlwdG8uY3JlYXRlSGFzaChcIm1kNVwiKS51cGRhdGUoZGF0YSkuZGlnZXN0KFwiaGV4XCIpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2hhMShkYXRhOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gY3J5cHRvLmNyZWF0ZUhhc2goXCJzaGExXCIpLnVwZGF0ZShkYXRhKS5kaWdlc3QoXCJoZXhcIik7XG4gICAgfVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBY087OztBQ2RQLGtCQVFPO0FBQ1AsdUJBQXlGOzs7QUNUekYsc0JBQWtEO0FBRzNDLG9CQUFvQixLQUFVLFlBQW9CLFVBQW9CO0FBQ3pFLFFBQU0sWUFBWSxXQUFXLHNCQUFzQjtBQUNuRCxRQUFNLGFBQWEsSUFBSSxRQUFRLFVBQVUsY0FBYyxFQUFFLFNBQVMsV0FBVyxLQUFLO0FBQ2xGLFFBQU0sbUJBQW1CLENBQUMsY0FBYywwQ0FBWSxZQUFXLElBQUksbUJBQW1CO0FBQ3RGLFFBQU0sU0FBUyxVQUFVLFdBQVcsYUFBYSxVQUFVLHVCQUF1QixrQkFBa0I7QUFFcEcsUUFBTSxTQUFTLElBQUkscUNBQXFCLE1BQU07QUFFOUMsTUFBSSxPQUFlO0FBQ25CLE1BQUksYUFBYSxTQUFTO0FBQ3RCLFlBQVE7QUFDUixXQUFPO0FBQUEsRUFDWCxPQUFPO0FBQ0gsWUFBUTtBQUNSLFdBQU87QUFBQSxFQUNYO0FBQ0EsU0FBTyxRQUFRLElBQUk7QUFDbkIsU0FBTyxXQUFXLDRCQUFPLFlBQVksZ0JBQWdCLEVBQUUsT0FBTyxxQkFBcUIsQ0FBQztBQUNwRixTQUFPO0FBQUEsSUFDSDtBQUFBLElBQ0E7QUFBQSxFQUNKO0FBQ0o7OztBRFhBLElBQU0sb0JBQU4sY0FBZ0MsdUJBQVc7QUFBQSxFQUN2QyxZQUNhLEtBQ0EsTUFDQSxNQUNBLElBQ0EsV0FBcUIsU0FDckIsWUFDWDtBQUNFLFVBQU07QUFQRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQSxFQUdiO0FBQUEsRUFFQSxHQUFHLE9BQTBCO0FB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
